<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Association between categorical variables | Learn R for biologist</title>
  <meta name="description" content="This course is for biologists who want to optimize their analysis, making them faster and reproducible." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Association between categorical variables | Learn R for biologist" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This course is for biologists who want to optimize their analysis, making them faster and reproducible." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Association between categorical variables | Learn R for biologist" />
  
  <meta name="twitter:description" content="This course is for biologists who want to optimize their analysis, making them faster and reproducible." />
  

<meta name="author" content="Matteo Miotto" />


<meta name="date" content="2024-02-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro-stat-chapter.html"/>
<link rel="next" href="comparing-two-groups.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<meta property="og:description" content="To you, who never gives up, for your future. You can make it!">
<meta name="keywords" content="R, biology, data analysis">
<meta name="author" content="Matteo Miotto">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YDEBEF61BH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YDEBEF61BH');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for biologist</a></li>
<li class="divider"></li>
<li><a href="index.html#about" id="toc-about">About</a></li>
<li><a href="installation.html#installation" id="toc-installation"><span class="toc-section-number">1</span> Installation</a></li>
<li><a href="first-step-in-rstudio.html#first-step-in-rstudio" id="toc-first-step-in-rstudio"><span class="toc-section-number">2</span> First step in RStudio</a>
<ul>
<li><a href="first-step-in-rstudio.html#console" id="toc-console">Console</a></li>
</ul></li>
<li><a href="variables.html#variables" id="toc-variables"><span class="toc-section-number">3</span> Variables</a>
<ul>
<li><a href="variables.html#create-a-variable" id="toc-create-a-variable">Create a variable</a></li>
<li><a href="variables.html#use-a-variable" id="toc-use-a-variable">Use a variable</a></li>
<li><a href="variables.html#variable-names" id="toc-variable-names">Variable names</a></li>
<li><a href="variables.html#overwriting-variables" id="toc-overwriting-variables">Overwriting variables</a></li>
<li><a href="variables.html#list-all-variables" id="toc-list-all-variables">List all variables</a></li>
<li><a href="variables.html#delete-variables" id="toc-delete-variables">Delete variables</a></li>
<li><a href="variables.html#type-of-variables" id="toc-type-of-variables">Type of variables</a></li>
<li><a href="variables.html#exercises" id="toc-exercises">Exercises</a></li>
</ul></li>
<li><a href="scripts-chapter.html#scripts-chapter" id="toc-scripts-chapter"><span class="toc-section-number">4</span> Scripts</a>
<ul>
<li><a href="scripts-chapter.html#save" id="toc-save">Save</a></li>
<li><a href="scripts-chapter.html#source-a-script" id="toc-source-a-script">Source a script</a></li>
</ul></li>
<li><a href="numbers.html#numbers" id="toc-numbers"><span class="toc-section-number">5</span> Numbers</a>
<ul>
<li><a href="numbers.html#operations" id="toc-operations">Operations</a></li>
<li><a href="numbers.html#rounding" id="toc-rounding">Rounding</a></li>
<li><a href="numbers.html#tranform-to-type-number" id="toc-tranform-to-type-number">Tranform to type number</a></li>
<li><a href="numbers.html#exercises-1" id="toc-exercises-1">Exercises</a></li>
</ul></li>
<li><a href="character.html#character" id="toc-character"><span class="toc-section-number">6</span> Character</a>
<ul>
<li><a href="character.html#concatenate-strings" id="toc-concatenate-strings">Concatenate strings</a></li>
<li><a href="character.html#substring" id="toc-substring">Substring</a></li>
<li><a href="character.html#substitution" id="toc-substitution">Substitution</a></li>
<li><a href="character.html#grep" id="toc-grep">Grep</a></li>
<li><a href="character.html#transform-to-type-character" id="toc-transform-to-type-character">Transform to type character</a></li>
<li><a href="character.html#exercises-2" id="toc-exercises-2">Exercises</a></li>
</ul></li>
<li><a href="boolean-chapter.html#boolean-chapter" id="toc-boolean-chapter"><span class="toc-section-number">7</span> Boolean</a>
<ul>
<li><a href="boolean-chapter.html#boolean-as-results-of-comparison" id="toc-boolean-as-results-of-comparison">Boolean as results of comparison</a></li>
<li><a href="boolean-chapter.html#logical-operator" id="toc-logical-operator">Logical operator</a>
<ul>
<li><a href="boolean-chapter.html#and" id="toc-and">AND</a></li>
<li><a href="boolean-chapter.html#or" id="toc-or">OR</a></li>
<li><a href="boolean-chapter.html#not" id="toc-not">NOT</a></li>
</ul></li>
<li><a href="boolean-chapter.html#exercises-3" id="toc-exercises-3">Exercises</a></li>
</ul></li>
<li><a href="vectors.html#vectors" id="toc-vectors"><span class="toc-section-number">8</span> Vectors</a>
<ul>
<li><a href="vectors.html#named-vectors" id="toc-named-vectors">Named vectors</a></li>
<li><a href="vectors.html#indexing" id="toc-indexing">Indexing</a>
<ul>
<li><a href="vectors.html#named-vectors-1" id="toc-named-vectors-1">Named vectors</a></li>
<li><a href="vectors.html#slicing-vectors" id="toc-slicing-vectors">Slicing</a></li>
<li><a href="vectors.html#using-logicals" id="toc-using-logicals">Using logicals</a></li>
</ul></li>
<li><a href="vectors.html#one-function-can-be-applied-to-all-elements" id="toc-one-function-can-be-applied-to-all-elements">One function can be applied to all elements</a></li>
<li><a href="vectors.html#functions-specific-of-vectors" id="toc-functions-specific-of-vectors">Functions specific of vectors</a>
<ul>
<li><a href="vectors.html#sorting-a-vector" id="toc-sorting-a-vector">Sorting a vector</a></li>
<li><a href="vectors.html#unique-values" id="toc-unique-values">Unique values</a></li>
<li><a href="vectors.html#logical-vectors-sum-and-mean" id="toc-logical-vectors-sum-and-mean">Logical vectors sum and mean</a></li>
</ul></li>
<li><a href="vectors.html#operations-between-vectors" id="toc-operations-between-vectors">Operations between vectors</a>
<ul>
<li><a href="vectors.html#mathematical" id="toc-mathematical">Mathematical</a></li>
<li><a href="vectors.html#different-and-common-elements" id="toc-different-and-common-elements">Different and common elements</a></li>
<li><a href="vectors.html#in" id="toc-in">%in%</a></li>
<li><a href="vectors.html#match" id="toc-match">Match</a></li>
</ul></li>
<li><a href="vectors.html#exercises-4" id="toc-exercises-4">Exercises</a></li>
</ul></li>
<li><a href="matrices.html#matrices" id="toc-matrices"><span class="toc-section-number">9</span> Matrices</a>
<ul>
<li><a href="matrices.html#create-a-matrix" id="toc-create-a-matrix">Create a matrix</a>
<ul>
<li><a href="matrices.html#binding" id="toc-binding">Binding</a></li>
<li><a href="matrices.html#transform-into-a-matrix" id="toc-transform-into-a-matrix">Transform into a matrix</a></li>
</ul></li>
<li><a href="matrices.html#rownames-and-colnames" id="toc-rownames-and-colnames">Rownames and colnames</a>
<ul>
<li><a href="matrices.html#set-and-edit-row-and-column-names" id="toc-set-and-edit-row-and-column-names">Set and edit row and column names</a></li>
</ul></li>
<li><a href="matrices.html#indexing-matrices" id="toc-indexing-matrices">Indexing</a>
<ul>
<li><a href="matrices.html#slicing" id="toc-slicing">Slicing</a></li>
<li><a href="matrices.html#using-names" id="toc-using-names">Using names</a></li>
<li><a href="matrices.html#using-logicals-1" id="toc-using-logicals-1">Using logicals</a></li>
</ul></li>
<li><a href="matrices.html#functions-for-all-matrix" id="toc-functions-for-all-matrix">Functions for all matrix</a>
<ul>
<li><a href="matrices.html#head-tail-matrices" id="toc-head-tail-matrices">Head/Tail</a></li>
<li><a href="matrices.html#dim-nrow-ncol" id="toc-dim-nrow-ncol">Dim, nrow, ncol</a></li>
<li><a href="matrices.html#summary-and-transpose" id="toc-summary-and-transpose">Summary and transpose</a></li>
<li><a href="matrices.html#sum-max-min" id="toc-sum-max-min">Sum, Max, Min, …</a></li>
</ul></li>
<li><a href="matrices.html#apply-a-function-to-all-rows-or-columns" id="toc-apply-a-function-to-all-rows-or-columns">Apply a function to all rows or columns</a></li>
<li><a href="matrices.html#exercises-5" id="toc-exercises-5">Exercises</a></li>
</ul></li>
<li><a href="data-frames.html#data-frames" id="toc-data-frames"><span class="toc-section-number">10</span> Data frames</a>
<ul>
<li><a href="data-frames.html#create-a-data.frame" id="toc-create-a-data.frame">Create a data.frame</a>
<ul>
<li><a href="data-frames.html#from-matrix" id="toc-from-matrix">From matrix</a></li>
<li><a href="data-frames.html#from-vectors" id="toc-from-vectors">From vectors</a></li>
<li><a href="data-frames.html#from-file" id="toc-from-file">From file</a></li>
</ul></li>
<li><a href="data-frames.html#indexing-1" id="toc-indexing-1">Indexing</a></li>
<li><a href="data-frames.html#create-a-new-column" id="toc-create-a-new-column">Create a new column</a></li>
<li><a href="data-frames.html#delete-a-column" id="toc-delete-a-column">Delete a column</a></li>
<li><a href="data-frames.html#export-a-data-frame" id="toc-export-a-data-frame">Export a data frame</a></li>
</ul></li>
<li><a href="functions-packages-and-reproducibility.html#functions-packages-and-reproducibility" id="toc-functions-packages-and-reproducibility"><span class="toc-section-number">11</span> Functions, packages and reproducibility</a>
<ul>
<li><a href="functions-packages-and-reproducibility.html#functions" id="toc-functions">Functions</a></li>
<li><a href="functions-packages-and-reproducibility.html#packages" id="toc-packages">Packages</a>
<ul>
<li><a href="functions-packages-and-reproducibility.html#install-a-package" id="toc-install-a-package">Install a package</a></li>
<li><a href="functions-packages-and-reproducibility.html#load-a-package" id="toc-load-a-package">Load a package</a></li>
</ul></li>
<li><a href="functions-packages-and-reproducibility.html#reproducibility" id="toc-reproducibility">Reproducibility</a>
<ul>
<li><a href="functions-packages-and-reproducibility.html#control-package-versions" id="toc-control-package-versions">Control package versions</a></li>
<li><a href="functions-packages-and-reproducibility.html#session-info" id="toc-session-info">Session info</a></li>
</ul></li>
</ul></li>
<li><a href="tidyverse-manage.html#tidyverse-manage" id="toc-tidyverse-manage"><span class="toc-section-number">12</span> Manage data with tidyverse</a>
<ul>
<li><a href="tidyverse-manage.html#r-notebook" id="toc-r-notebook">R notebook</a></li>
<li><a href="tidyverse-manage.html#load-packages-and-data" id="toc-load-packages-and-data">Load packages and data</a></li>
<li><a href="tidyverse-manage.html#dataset-structure" id="toc-dataset-structure">Dataset structure</a>
<ul>
<li><a href="tidyverse-manage.html#change-column-type" id="toc-change-column-type">Change column type</a></li>
<li><a href="tidyverse-manage.html#reorder-levels-of-a-factor" id="toc-reorder-levels-of-a-factor">Reorder levels of a factor</a></li>
</ul></li>
<li><a href="tidyverse-manage.html#summary" id="toc-summary">Summary</a></li>
<li><a href="tidyverse-manage.html#dealing-with-missing-values" id="toc-dealing-with-missing-values">Dealing with missing values</a></li>
<li><a href="tidyverse-manage.html#filter-a-dataframe" id="toc-filter-a-dataframe">Filter a dataframe</a></li>
<li><a href="tidyverse-manage.html#sort-for-the-value-of-a-column" id="toc-sort-for-the-value-of-a-column">Sort for the value of a column</a></li>
<li><a href="tidyverse-manage.html#merge-two-columns" id="toc-merge-two-columns">Merge two columns</a></li>
<li><a href="tidyverse-manage.html#split-two-columns" id="toc-split-two-columns">Split two columns</a></li>
<li><a href="tidyverse-manage.html#merge-two-dataframes" id="toc-merge-two-dataframes">Merge two dataframes</a></li>
<li><a href="tidyverse-manage.html#exercises-6" id="toc-exercises-6">Exercises</a></li>
</ul></li>
<li><a href="aggregate-data-with-tidyverse.html#aggregate-data-with-tidyverse" id="toc-aggregate-data-with-tidyverse"><span class="toc-section-number">13</span> Aggregate data with tidyverse</a>
<ul>
<li><a href="aggregate-data-with-tidyverse.html#table" id="toc-table">Table</a></li>
<li><a href="aggregate-data-with-tidyverse.html#group-by-variables-and-summarize-values-of-another" id="toc-group-by-variables-and-summarize-values-of-another">Group by variables and summarize values of another</a></li>
<li><a href="aggregate-data-with-tidyverse.html#expand-dataframe-column-using-pivot-wider" id="toc-expand-dataframe-column-using-pivot-wider">Expand dataframe column using pivot wider</a></li>
<li><a href="aggregate-data-with-tidyverse.html#reshape-a-dataframe-with-pivot_longer" id="toc-reshape-a-dataframe-with-pivot_longer">Reshape a dataframe with pivot_longer</a></li>
<li><a href="aggregate-data-with-tidyverse.html#exercises-7" id="toc-exercises-7">Exercises</a></li>
</ul></li>
<li><a href="plot-our-data-with-ggplot2.html#plot-our-data-with-ggplot2" id="toc-plot-our-data-with-ggplot2"><span class="toc-section-number">14</span> Plot our data with ggplot2</a>
<ul>
<li><a href="plot-our-data-with-ggplot2.html#command-structure" id="toc-command-structure">Command structure</a></li>
<li><a href="plot-our-data-with-ggplot2.html#type-of-graph-geom_-and-stat_" id="toc-type-of-graph-geom_-and-stat_">Type of graph (geom_ and stat_)</a>
<ul>
<li><a href="plot-our-data-with-ggplot2.html#mapping-values-to-graph-elements-aes" id="toc-mapping-values-to-graph-elements-aes">Mapping values to graph elements (aes)</a></li>
<li><a href="plot-our-data-with-ggplot2.html#change-the-stat-associated-to-the-graph" id="toc-change-the-stat-associated-to-the-graph">Change the “stat” associated to the graph</a></li>
<li><a href="plot-our-data-with-ggplot2.html#multiple-geometries-in-the-same-plot" id="toc-multiple-geometries-in-the-same-plot">Multiple geometries in the same plot</a></li>
</ul></li>
<li><a href="plot-our-data-with-ggplot2.html#change-axis-and-colors-scale_" id="toc-change-axis-and-colors-scale_">Change axis and colors (scale_)</a></li>
<li><a href="plot-our-data-with-ggplot2.html#add-title-and-change-labels-labs" id="toc-add-title-and-change-labels-labs">Add title and change labels (labs)</a></li>
<li><a href="plot-our-data-with-ggplot2.html#change-appearence-theme" id="toc-change-appearence-theme">Change appearence (theme)</a></li>
<li><a href="plot-our-data-with-ggplot2.html#save-plot" id="toc-save-plot">Save plot</a></li>
</ul></li>
<li><a href="intro-stat-chapter.html#intro-stat-chapter" id="toc-intro-stat-chapter"><span class="toc-section-number">15</span> Introduction to statistics in R</a>
<ul>
<li><a href="intro-stat-chapter.html#evaluate-parametric-assumptions" id="toc-evaluate-parametric-assumptions">Evaluate parametric assumptions</a>
<ul>
<li><a href="intro-stat-chapter.html#visual-inspection" id="toc-visual-inspection">Visual inspection</a></li>
<li><a href="intro-stat-chapter.html#no-outliers" id="toc-no-outliers">No outliers</a></li>
<li><a href="intro-stat-chapter.html#normality" id="toc-normality">Normality</a>
<ul>
<li><a href="intro-stat-chapter.html#shapiro-wilk-normality-test" id="toc-shapiro-wilk-normality-test">Shapiro-Wilk normality test</a></li>
<li><a href="intro-stat-chapter.html#kolmogorov-smirnov-test" id="toc-kolmogorov-smirnov-test">Kolmogorov-Smirnov test</a></li>
</ul></li>
<li><a href="intro-stat-chapter.html#homogeneity-of-variances-homoschedaticity" id="toc-homogeneity-of-variances-homoschedaticity">Homogeneity of variances (homoschedaticity)</a></li>
</ul></li>
</ul></li>
<li><a href="association-between-categorical-variables.html#association-between-categorical-variables" id="toc-association-between-categorical-variables"><span class="toc-section-number">16</span> Association between categorical variables</a>
<ul>
<li><a href="association-between-categorical-variables.html#fisher-exact-test" id="toc-fisher-exact-test">Fisher exact test</a>
<ul>
<li><a href="association-between-categorical-variables.html#phi-φ-coefficient" id="toc-phi-φ-coefficient">Phi (φ) Coefficient</a></li>
</ul></li>
<li><a href="association-between-categorical-variables.html#chi-squared-test-with-yates-correction" id="toc-chi-squared-test-with-yates-correction">Chi-Squared test with Yates correction</a></li>
<li><a href="association-between-categorical-variables.html#chi-squared-test-without-correction" id="toc-chi-squared-test-without-correction">Chi-Squared test without correction</a>
<ul>
<li><a href="association-between-categorical-variables.html#cramers-v" id="toc-cramers-v">Cramer’s V</a></li>
</ul></li>
</ul></li>
<li><a href="comparing-two-groups.html#comparing-two-groups" id="toc-comparing-two-groups"><span class="toc-section-number">17</span> Comparing two groups</a>
<ul>
<li><a href="comparing-two-groups.html#t-test" id="toc-t-test">T-test</a></li>
<li><a href="comparing-two-groups.html#welchs-test" id="toc-welchs-test">Welch’s test</a></li>
<li><a href="comparing-two-groups.html#mann-whitney-and-wilcoxon" id="toc-mann-whitney-and-wilcoxon">Mann-Whitney and Wilcoxon</a></li>
<li><a href="comparing-two-groups.html#add-values-to-graph" id="toc-add-values-to-graph">Add values to graph</a></li>
</ul></li>
<li><a href="comparing-more-groups.html#comparing-more-groups" id="toc-comparing-more-groups"><span class="toc-section-number">18</span> Comparing more groups</a>
<ul>
<li><a href="comparing-more-groups.html#anova" id="toc-anova">ANOVA</a>
<ul>
<li><a href="comparing-more-groups.html#post-hoc-test" id="toc-post-hoc-test">Post-hoc test</a></li>
</ul></li>
<li><a href="comparing-more-groups.html#kruskal-wallis" id="toc-kruskal-wallis">Kruskal Wallis</a>
<ul>
<li><a href="comparing-more-groups.html#post-hoc-test-1" id="toc-post-hoc-test-1">Post-hoc test</a></li>
</ul></li>
</ul></li>
<li><a href="correlation.html#correlation" id="toc-correlation"><span class="toc-section-number">19</span> Correlation</a>
<ul>
<li><a href="correlation.html#pearsons-test" id="toc-pearsons-test">Pearson’s test</a></li>
</ul></li>
<li><a href="farewell.html#farewell" id="toc-farewell"><span class="toc-section-number">20</span> Farewell</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learn R for biologist</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="association-between-categorical-variables" class="section level1" number="16">
<h1><span class="header-section-number">16</span> Association between categorical variables</h1>
<p>We’ll start our little journey on statistical tests in R with the ones used to evaluate the association between categorical variables.
<br>
There are two tests used to test if two categorical variables are independent or not: <strong>Fisher’s exact test</strong> and <strong>Chi-Squared test</strong>. They interpretation of the p-value of these tests is the same, as in both cases a p-value &lt; threshold (e.g. 0.05) means that we reject the null hypothesis that the two variables are independent.
<br>
The first one (Fisher’s) is used <u>only</u> when we have a small sample size 2x2 contingency matrix (so when the two categorical variables have 2 categories each) and at least one expected value is &lt; 5. In the same scenario, but with <u>all expected values &gt; 5</u>, Chi-Squared test with Yates correction is used, while in all other scenarios it is used Chi-Squared test without correction.
<br></p>
<p>Here, we will see some examples on when to use these tests. Let’s load the required libraries and our data first:</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="association-between-categorical-variables.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Load packages </span></span>
<span id="cb509-2"><a href="association-between-categorical-variables.html#cb509-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb509-3"><a href="association-between-categorical-variables.html#cb509-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(ggplot2))</span>
<span id="cb509-4"><a href="association-between-categorical-variables.html#cb509-4" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(ggmosaic))</span>
<span id="cb509-5"><a href="association-between-categorical-variables.html#cb509-5" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(vcd))</span>
<span id="cb509-6"><a href="association-between-categorical-variables.html#cb509-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-7"><a href="association-between-categorical-variables.html#cb509-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Load data</span></span>
<span id="cb509-8"><a href="association-between-categorical-variables.html#cb509-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/Stat-test-dataset.csv&quot;</span>)</span>
<span id="cb509-9"><a href="association-between-categorical-variables.html#cb509-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-10"><a href="association-between-categorical-variables.html#cb509-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Change come column types</span></span>
<span id="cb509-11"><a href="association-between-categorical-variables.html#cb509-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb509-12"><a href="association-between-categorical-variables.html#cb509-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;sex&quot;</span> <span class="ot">=</span> <span class="fu">factor</span>(sex),</span>
<span id="cb509-13"><a href="association-between-categorical-variables.html#cb509-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;treatment&quot;</span> <span class="ot">=</span> <span class="fu">factor</span>(treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;T1&quot;</span>, <span class="st">&quot;Untreated&quot;</span>)),</span>
<span id="cb509-14"><a href="association-between-categorical-variables.html#cb509-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Task1&quot;</span> <span class="ot">=</span> <span class="fu">factor</span>(Task1, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb509-15"><a href="association-between-categorical-variables.html#cb509-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Task2&quot;</span> <span class="ot">=</span> <span class="fu">factor</span>(Task2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb509-16"><a href="association-between-categorical-variables.html#cb509-16" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb509-17"><a href="association-between-categorical-variables.html#cb509-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-18"><a href="association-between-categorical-variables.html#cb509-18" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<pre class="code-out"><code>&#39;data.frame&#39;:   600 obs. of  7 variables:
 $ sex      : Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 2 1 2 1 2 1 2 1 2 1 ...
 $ age      : int  3 3 3 3 3 3 3 3 3 3 ...
 $ treatment: Factor w/ 2 levels &quot;T1&quot;,&quot;Untreated&quot;: 2 2 1 1 2 2 1 1 2 2 ...
 $ weight   : num  6.43 3.42 4.97 4.63 7.31 3.27 5.58 3.27 5.9 4.22 ...
 $ Task1    : Factor w/ 2 levels &quot;1&quot;,&quot;0&quot;: 1 2 2 2 1 1 1 1 2 1 ...
 $ Task2    : Factor w/ 2 levels &quot;1&quot;,&quot;0&quot;: 1 2 2 1 1 2 2 1 1 1 ...
 $ Task3    : num  222.4 202.3 36.7 221.8 178.8 ...</code></pre>
This time, I also loaded the <code>ggmosaic</code> package, we will use it to create mosaic plots of our data. You can install it through <code>install.packages("ggmosaic")</code>.
<br>
<p class="plist">
Now that we have our data loaded, here are the comparisons we want to do:
</p>
<ol>
<li>
In Male at age 3 that have successfully done Task2, is there an association between the treatment and the success on Task1?
</li>
<li>
In Female at age 15 that have successfully done Task1, is there an association between the treatment and the success on Task2?
</li>
<li>
In Untreated mice, is there any association between the age and the success on Task1?
</li>
</ol>
<p>Now, for each comparison, we have to decide which test we want to use. To evaluate sample size and number of categories we will use <code>table</code>:</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="association-between-categorical-variables.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Filter data</span></span>
<span id="cb511-2"><a href="association-between-categorical-variables.html#cb511-2" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb511-3"><a href="association-between-categorical-variables.html#cb511-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>, age <span class="sc">==</span> <span class="dv">3</span>, Task2 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb511-4"><a href="association-between-categorical-variables.html#cb511-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-5"><a href="association-between-categorical-variables.html#cb511-5" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb511-6"><a href="association-between-categorical-variables.html#cb511-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>, age <span class="sc">==</span> <span class="dv">15</span>, Task1 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb511-7"><a href="association-between-categorical-variables.html#cb511-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-8"><a href="association-between-categorical-variables.html#cb511-8" aria-hidden="true" tabindex="-1"></a>untreated_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb511-9"><a href="association-between-categorical-variables.html#cb511-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">&quot;Untreated&quot;</span>)</span>
<span id="cb511-10"><a href="association-between-categorical-variables.html#cb511-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-11"><a href="association-between-categorical-variables.html#cb511-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create contingency tables</span></span>
<span id="cb511-12"><a href="association-between-categorical-variables.html#cb511-12" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_table    <span class="ot">&lt;-</span> <span class="fu">table</span>(male_3_task2yes_df<span class="sc">$</span>treatment, male_3_task2yes_df<span class="sc">$</span>Task1)</span>
<span id="cb511-13"><a href="association-between-categorical-variables.html#cb511-13" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_table <span class="ot">&lt;-</span> <span class="fu">table</span>(female_15_task1yes_df<span class="sc">$</span>treatment, female_15_task1yes_df<span class="sc">$</span>Task2)</span>
<span id="cb511-14"><a href="association-between-categorical-variables.html#cb511-14" aria-hidden="true" tabindex="-1"></a>untreated_table          <span class="ot">&lt;-</span> <span class="fu">table</span>(untreated_df<span class="sc">$</span>age, untreated_df<span class="sc">$</span>Task1)</span>
<span id="cb511-15"><a href="association-between-categorical-variables.html#cb511-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-16"><a href="association-between-categorical-variables.html#cb511-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Get sample size</span></span>
<span id="cb511-17"><a href="association-between-categorical-variables.html#cb511-17" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_sample_size    <span class="ot">&lt;-</span> <span class="fu">sum</span>(male_3_task2yes_table)</span>
<span id="cb511-18"><a href="association-between-categorical-variables.html#cb511-18" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_sample_size <span class="ot">&lt;-</span> <span class="fu">sum</span>(female_15_task1yes_table)</span>
<span id="cb511-19"><a href="association-between-categorical-variables.html#cb511-19" aria-hidden="true" tabindex="-1"></a>untreated_sample_size          <span class="ot">&lt;-</span> <span class="fu">sum</span>(untreated_table)</span>
<span id="cb511-20"><a href="association-between-categorical-variables.html#cb511-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-21"><a href="association-between-categorical-variables.html#cb511-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Get max number of categories</span></span>
<span id="cb511-22"><a href="association-between-categorical-variables.html#cb511-22" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_max_cat    <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">dim</span>(male_3_task2yes_table))</span>
<span id="cb511-23"><a href="association-between-categorical-variables.html#cb511-23" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_max_cat <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">dim</span>(female_15_task1yes_table))</span>
<span id="cb511-24"><a href="association-between-categorical-variables.html#cb511-24" aria-hidden="true" tabindex="-1"></a>untreated_max_cat   <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">dim</span>(untreated_table))</span></code></pre></div>
<p>Now that we have all the info, let’s check them:
<em>In Male at age 3 that have successfully done Task2, is there an association between the treatment and the success on Task1?</em></p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="association-between-categorical-variables.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(male_3_task2yes_table)</span></code></pre></div>
<pre class="code-out"><code>           
             1  0
  T1         4 13
  Untreated  5 13</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="association-between-categorical-variables.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample size:&quot;</span>, male_3_task2yes_sample_size, </span>
<span id="cb514-2"><a href="association-between-categorical-variables.html#cb514-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Max number of categories:&quot;</span>, male_3_task2yes_max_cat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre class="code-out"><code>Sample size: 35 
Max number of categories: 2 </code></pre>
<p class="plist">
What can we say?
<p>
<ul>
<li>
First of all, it is <strong>always</strong> recommended to look at the contingency table as starting point
</li>
<li>
Sample size is low, it is a 2x2 contingency matrix. So we have to look at the expected values to decide whether to use Fisher’s exact test or Chi-Squared test with Yates correction
</li>
</ul>
<p>To do so, we will use <code>chisq.test</code> function, extrapolating the expected values from the results. I know, it is “silly” that we have to actually perform chi-squared test to get the expected values…</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="association-between-categorical-variables.html#cb516-1" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_expected <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(male_3_task2yes_table)<span class="sc">$</span>expected</span>
<span id="cb516-2"><a href="association-between-categorical-variables.html#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Minimum expected value is:&quot;</span>, <span class="fu">min</span>(male_3_task2yes_expected))</span></code></pre></div>
<pre class="code-out"><code>Minimum expected value is: 4.371429</code></pre>
<p>As it is &lt; 5, we will use Fisher’s exact test in this scenario.</p>
<p><em>In Female at age 15 that have successfully done Task1, is there an association between the treatment and the success on Task2?</em></p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="association-between-categorical-variables.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(female_15_task1yes_table)</span></code></pre></div>
<pre class="code-out"><code>           
             1  0
  T1        26  3
  Untreated  7 14</code></pre>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="association-between-categorical-variables.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample size:&quot;</span>, female_15_task1yes_sample_size, </span>
<span id="cb520-2"><a href="association-between-categorical-variables.html#cb520-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Max number of categories:&quot;</span>, female_15_task1yes_max_cat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre class="code-out"><code>Sample size: 50 
Max number of categories: 2 </code></pre>
<p class="plist">
What can we say?
<p>
<ul>
<li>
Sample size is low, it is a 2x2 contingency matrix. So we have to look at the expected values to decide whether to use Fisher’s exact test or Chi-Squared test with Yates correction
</li>
</ul>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="association-between-categorical-variables.html#cb522-1" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_expected <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(female_15_task1yes_table)<span class="sc">$</span>expected</span>
<span id="cb522-2"><a href="association-between-categorical-variables.html#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Minimum expected value is:&quot;</span>, <span class="fu">min</span>(female_15_task1yes_expected))</span></code></pre></div>
<pre class="code-out"><code>Minimum expected value is: 7.14</code></pre>
<p>As it is &gt; 5, we will use Chi-Squared test with Yates correction in this scenario.</p>
<p><em>In Untreated mice, is there any association between the age and the success on Task1?</em></p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="association-between-categorical-variables.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(untreated_table)</span></code></pre></div>
<pre class="code-out"><code>    
      1  0
  3  20 56
  7  39 35
  15 42 34
  30 69  5</code></pre>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="association-between-categorical-variables.html#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample size:&quot;</span>, untreated_sample_size, </span>
<span id="cb526-2"><a href="association-between-categorical-variables.html#cb526-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Max number of categories:&quot;</span>, untreated_max_cat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre class="code-out"><code>Sample size: 300 
Max number of categories: 4 </code></pre>
<p class="plist">
What can we say?
<p>
<ul>
<li>
Sample size is low, it is a 4x2 contingency matrix. So we have to use Chi-Squared test
</li>
</ul>
<div id="fisher-exact-test" class="section level2 unnumbered">
<h2>Fisher exact test</h2>
<p>Now that we have decided which test to use, let’s start evaluating if there is an association between the treatment and the success on Task1 in Male at age 3 that have successfully done Task2.
<br>
We already have the contingency table, and we know we should use the Fisher’s exact test; but, let’s do a mosaic plot that can be the then updated with the statistics and can be used a figure to show the results:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="association-between-categorical-variables.html#cb528-1" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_mosaic <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(male_3_task2yes_df) <span class="sc">+</span></span>
<span id="cb528-2"><a href="association-between-categorical-variables.html#cb528-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(treatment), <span class="at">fill =</span> Task1), <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb528-3"><a href="association-between-categorical-variables.html#cb528-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb528-4"><a href="association-between-categorical-variables.html#cb528-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Task1 success rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb528-5"><a href="association-between-categorical-variables.html#cb528-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#76B041&quot;</span>, <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;#D9481C&quot;</span>)) <span class="sc">+</span></span>
<span id="cb528-6"><a href="association-between-categorical-variables.html#cb528-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb528-7"><a href="association-between-categorical-variables.html#cb528-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb528-8"><a href="association-between-categorical-variables.html#cb528-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.07</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb528-9"><a href="association-between-categorical-variables.html#cb528-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb528-10"><a href="association-between-categorical-variables.html#cb528-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-11"><a href="association-between-categorical-variables.html#cb528-11" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_mosaic</span></code></pre></div>
<p><img src="_main_files/figure-html/fisher_mosaic-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>Great, let’s have a look again at the contingency table, and then perform Fisher’s exact test:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="association-between-categorical-variables.html#cb529-1" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_table</span></code></pre></div>
<pre class="code-out"><code>           
             1  0
  T1         4 13
  Untreated  5 13</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="association-between-categorical-variables.html#cb531-1" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_fisher_res <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(male_3_task2yes_table)</span>
<span id="cb531-2"><a href="association-between-categorical-variables.html#cb531-2" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_fisher_res</span></code></pre></div>
<pre class="code-out"><code>
    Fisher&#39;s Exact Test for Count Data

data:  male_3_task2yes_table
p-value = 1
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.1281067 4.7303300
sample estimates:
odds ratio 
 0.8051144 </code></pre>
<p class="plist">
How to interpret these data:
</p>
<ul>
<li>
<em>odds ratio</em>: it indicates the odds of success in Task1 of T1-treated mice compared to untreated, so it seems that the former perform worst than the latter in this task
</li>
<li>
<em>p-value</em>: in this case, it indicates that the two variables are independent, so that there is <u>no influence</u> of treatment in the outcome of Task1 in Male at P3 that have successfully performed in Task2
</li>
</ul>
<div id="phi-φ-coefficient" class="section level3 unnumbered">
<h3>Phi (φ) Coefficient</h3>
<p>The Phi (φ) Coefficient is used as a measure of association, indicating the strength and direction of association between two binary categorical variables in a 2x2 contingency table. It ranges from -1 to 1, with values closer to -1 or 1 indicating stronger associations.
<br>
Our results have already indicated that there is no association of the two variables, but we will calculate it as it may be useful in other cases, where the Fisher’s exact test is significant. To do so, we will use the <code>assocstats</code> function from package <code>vcd</code> (this function returns multiple scores, we will take only phi):</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="association-between-categorical-variables.html#cb533-1" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_fisher_phi <span class="ot">&lt;-</span> <span class="fu">assocstats</span>(male_3_task2yes_table)<span class="sc">$</span>phi</span>
<span id="cb533-2"><a href="association-between-categorical-variables.html#cb533-2" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_fisher_phi</span></code></pre></div>
<pre class="code-out"><code>[1] 0.04858192</code></pre>
<p>As expected, Phi Coefficient is very low. Let’s update our plot with these info:</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="association-between-categorical-variables.html#cb535-1" aria-hidden="true" tabindex="-1"></a>n_untreated <span class="ot">&lt;-</span> <span class="fu">sum</span>(male_3_task2yes_df<span class="sc">$</span>treatment <span class="sc">==</span> <span class="st">&quot;Untreated&quot;</span>)</span>
<span id="cb535-2"><a href="association-between-categorical-variables.html#cb535-2" aria-hidden="true" tabindex="-1"></a>n_t1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(male_3_task2yes_df<span class="sc">$</span>treatment <span class="sc">==</span> <span class="st">&quot;T1&quot;</span>)</span>
<span id="cb535-3"><a href="association-between-categorical-variables.html#cb535-3" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">case_when</span>(male_3_task2yes_fisher_res<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="fu">as.character</span>(<span class="fu">round</span>(male_3_task2yes_fisher_res<span class="sc">$</span>p.value, <span class="dv">3</span>)),</span>
<span id="cb535-4"><a href="association-between-categorical-variables.html#cb535-4" aria-hidden="true" tabindex="-1"></a>                    male_3_task2yes_fisher_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.0001</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.0001&quot;</span>,</span>
<span id="cb535-5"><a href="association-between-categorical-variables.html#cb535-5" aria-hidden="true" tabindex="-1"></a>                    male_3_task2yes_fisher_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.001&quot;</span>,</span>
<span id="cb535-6"><a href="association-between-categorical-variables.html#cb535-6" aria-hidden="true" tabindex="-1"></a>                    male_3_task2yes_fisher_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.01&quot;</span>,</span>
<span id="cb535-7"><a href="association-between-categorical-variables.html#cb535-7" aria-hidden="true" tabindex="-1"></a>                    male_3_task2yes_fisher_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.05&quot;</span>,</span>
<span id="cb535-8"><a href="association-between-categorical-variables.html#cb535-8" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb535-9"><a href="association-between-categorical-variables.html#cb535-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-10"><a href="association-between-categorical-variables.html#cb535-10" aria-hidden="true" tabindex="-1"></a>caption <span class="ot">&lt;-</span>  <span class="fu">paste0</span>(<span class="st">&quot;Task1 success rate (1: success; 0: fail) of Male P3 mice who have successfully performed in Task2 (n = &quot;</span>,</span>
<span id="cb535-11"><a href="association-between-categorical-variables.html#cb535-11" aria-hidden="true" tabindex="-1"></a>                   male_3_task2yes_sample_size, <span class="st">&quot;), in the two treatment conditions (Untreated n = &quot;</span>, </span>
<span id="cb535-12"><a href="association-between-categorical-variables.html#cb535-12" aria-hidden="true" tabindex="-1"></a>                   n_t1, <span class="st">&quot;, T1-treated n = &quot;</span>, n_untreated, <span class="st">&quot;). Statistics calculated through Fisher&#39;s exact test.&quot;</span>)</span>
<span id="cb535-13"><a href="association-between-categorical-variables.html#cb535-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-14"><a href="association-between-categorical-variables.html#cb535-14" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_mosaic <span class="ot">&lt;-</span> male_3_task2yes_mosaic <span class="sc">+</span></span>
<span id="cb535-15"><a href="association-between-categorical-variables.html#cb535-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;φ: &quot;</span>, <span class="fu">round</span>(male_3_task2yes_fisher_phi, <span class="dv">3</span>), </span>
<span id="cb535-16"><a href="association-between-categorical-variables.html#cb535-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;, OR: &quot;</span>, <span class="fu">round</span>(male_3_task2yes_fisher_res<span class="sc">$</span>estimate, <span class="dv">3</span>), </span>
<span id="cb535-17"><a href="association-between-categorical-variables.html#cb535-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;, p-value: &quot;</span>, pvalue), </span>
<span id="cb535-18"><a href="association-between-categorical-variables.html#cb535-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">str_wrap</span>(caption, <span class="at">width =</span> <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb535-19"><a href="association-between-categorical-variables.html#cb535-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.07</span>),</span>
<span id="cb535-20"><a href="association-between-categorical-variables.html#cb535-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">debug =</span> F, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span> <span class="dv">20</span>)),</span>
<span id="cb535-21"><a href="association-between-categorical-variables.html#cb535-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption.position =</span> <span class="st">&quot;plot&quot;</span>)</span>
<span id="cb535-22"><a href="association-between-categorical-variables.html#cb535-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-23"><a href="association-between-categorical-variables.html#cb535-23" aria-hidden="true" tabindex="-1"></a>male_3_task2yes_mosaic</span></code></pre></div>
<p><img src="_main_files/figure-html/fisher_mosaic2-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>Great! We have a nice figure to present!</p>
</div>
</div>
<div id="chi-squared-test-with-yates-correction" class="section level2 unnumbered">
<h2>Chi-Squared test with Yates correction</h2>
<p>Now, let’s evaluate the scenario that has to be be assessed through Chi-Squared test with Yates correction. <br>
As in Fisher’s exact test example, we’ll make the mosaic plot first:</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="association-between-categorical-variables.html#cb536-1" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_mosaic <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(female_15_task1yes_df) <span class="sc">+</span></span>
<span id="cb536-2"><a href="association-between-categorical-variables.html#cb536-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(treatment), <span class="at">fill =</span> Task2), <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb536-3"><a href="association-between-categorical-variables.html#cb536-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb536-4"><a href="association-between-categorical-variables.html#cb536-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Task2 success rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb536-5"><a href="association-between-categorical-variables.html#cb536-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#76B041&quot;</span>, <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;#D9481C&quot;</span>)) <span class="sc">+</span></span>
<span id="cb536-6"><a href="association-between-categorical-variables.html#cb536-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb536-7"><a href="association-between-categorical-variables.html#cb536-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb536-8"><a href="association-between-categorical-variables.html#cb536-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.07</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb536-9"><a href="association-between-categorical-variables.html#cb536-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb536-10"><a href="association-between-categorical-variables.html#cb536-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-11"><a href="association-between-categorical-variables.html#cb536-11" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_mosaic</span></code></pre></div>
<p><img src="_main_files/figure-html/chi_squared_yates_mosaic-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>Wow, here the difference is striking. Let’s see the contingency matrix and perform the test:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="association-between-categorical-variables.html#cb537-1" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_table</span></code></pre></div>
<pre class="code-out"><code>           
             1  0
  T1        26  3
  Untreated  7 14</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="association-between-categorical-variables.html#cb539-1" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_chisq_res <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(female_15_task1yes_table, <span class="at">correct =</span> T)</span>
<span id="cb539-2"><a href="association-between-categorical-variables.html#cb539-2" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_chisq_res</span></code></pre></div>
<pre class="code-out"><code>
    Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  female_15_task1yes_table
X-squared = 14.799, df = 1, p-value = 0.0001196</code></pre>
<p>Compared to Fisher’s exact test, here we look just at p-value as odds-ratio are not calculated by default (this is because we can calculate OR only in 2x2 contingency matrix, and chisq.test can accept greater matrices). In this case, we can say that the outcome of Task1 can be due to treatment (<strong>remember</strong>: correlation or absence of independence is not causation!).
<br>
As this is a 2x2 contingency matrix and the odds ratio, we can use Phi Coefficient to measure the association between the two variables:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="association-between-categorical-variables.html#cb541-1" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_phi <span class="ot">&lt;-</span> <span class="fu">assocstats</span>(female_15_task1yes_table)<span class="sc">$</span>phi</span>
<span id="cb541-2"><a href="association-between-categorical-variables.html#cb541-2" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_phi</span></code></pre></div>
<pre class="code-out"><code>[1] 0.5868188</code></pre>
<p>There is quite a good positive association!</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="association-between-categorical-variables.html#cb543-1" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_or <span class="ot">&lt;-</span> (female_15_task1yes_table[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">*</span> female_15_task1yes_table[<span class="dv">2</span>, <span class="dv">2</span>]) <span class="sc">/</span> (female_15_task1yes_table[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">*</span> female_15_task1yes_table[<span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb543-2"><a href="association-between-categorical-variables.html#cb543-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb543-3"><a href="association-between-categorical-variables.html#cb543-3" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_or</span></code></pre></div>
<pre class="code-out"><code>[1] 17.33333</code></pre>
<p>Wow! The OR is huge!<br>
This has to be inserted in the plot:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="association-between-categorical-variables.html#cb545-1" aria-hidden="true" tabindex="-1"></a>n_untreated <span class="ot">&lt;-</span> <span class="fu">sum</span>(female_15_task1yes_df<span class="sc">$</span>treatment <span class="sc">==</span> <span class="st">&quot;Untreated&quot;</span>)</span>
<span id="cb545-2"><a href="association-between-categorical-variables.html#cb545-2" aria-hidden="true" tabindex="-1"></a>n_t1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(female_15_task1yes_df<span class="sc">$</span>treatment <span class="sc">==</span> <span class="st">&quot;T1&quot;</span>)</span>
<span id="cb545-3"><a href="association-between-categorical-variables.html#cb545-3" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">case_when</span>(female_15_task1yes_chisq_res<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="fu">as.character</span>(<span class="fu">round</span>(female_15_task1yes_chisq_res<span class="sc">$</span>p.value, <span class="dv">3</span>)),</span>
<span id="cb545-4"><a href="association-between-categorical-variables.html#cb545-4" aria-hidden="true" tabindex="-1"></a>                    female_15_task1yes_chisq_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.0001</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.0001&quot;</span>,</span>
<span id="cb545-5"><a href="association-between-categorical-variables.html#cb545-5" aria-hidden="true" tabindex="-1"></a>                    female_15_task1yes_chisq_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.001&quot;</span>,</span>
<span id="cb545-6"><a href="association-between-categorical-variables.html#cb545-6" aria-hidden="true" tabindex="-1"></a>                    female_15_task1yes_chisq_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.01&quot;</span>,</span>
<span id="cb545-7"><a href="association-between-categorical-variables.html#cb545-7" aria-hidden="true" tabindex="-1"></a>                    female_15_task1yes_chisq_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.05&quot;</span>,</span>
<span id="cb545-8"><a href="association-between-categorical-variables.html#cb545-8" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb545-9"><a href="association-between-categorical-variables.html#cb545-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-10"><a href="association-between-categorical-variables.html#cb545-10" aria-hidden="true" tabindex="-1"></a>caption <span class="ot">&lt;-</span>  <span class="fu">paste0</span>(<span class="st">&quot;Task2 success rate (1: success; 0: fail) of Female P15 mice who have successfully performed in Task1 (n = &quot;</span>,</span>
<span id="cb545-11"><a href="association-between-categorical-variables.html#cb545-11" aria-hidden="true" tabindex="-1"></a>                   female_15_task1yes_sample_size, <span class="st">&quot;), in the two treatment conditions (Untreated n = &quot;</span>, </span>
<span id="cb545-12"><a href="association-between-categorical-variables.html#cb545-12" aria-hidden="true" tabindex="-1"></a>                   n_t1, <span class="st">&quot;, T1-treated n = &quot;</span>, n_untreated, <span class="st">&quot;). Statistics calculated through Fisher&#39;s exact test.&quot;</span>)</span>
<span id="cb545-13"><a href="association-between-categorical-variables.html#cb545-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-14"><a href="association-between-categorical-variables.html#cb545-14" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_mosaic <span class="ot">&lt;-</span> female_15_task1yes_mosaic <span class="sc">+</span></span>
<span id="cb545-15"><a href="association-between-categorical-variables.html#cb545-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;φ: &quot;</span>, <span class="fu">round</span>(female_15_task1yes_phi, <span class="dv">3</span>), </span>
<span id="cb545-16"><a href="association-between-categorical-variables.html#cb545-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;, OR: &quot;</span>, <span class="fu">round</span>(female_15_task1yes_or, <span class="dv">3</span>), </span>
<span id="cb545-17"><a href="association-between-categorical-variables.html#cb545-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;, p-value: &quot;</span>, pvalue), </span>
<span id="cb545-18"><a href="association-between-categorical-variables.html#cb545-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">str_wrap</span>(caption, <span class="at">width =</span> <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb545-19"><a href="association-between-categorical-variables.html#cb545-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.07</span>),</span>
<span id="cb545-20"><a href="association-between-categorical-variables.html#cb545-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">debug =</span> F, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span> <span class="dv">20</span>)),</span>
<span id="cb545-21"><a href="association-between-categorical-variables.html#cb545-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption.position =</span> <span class="st">&quot;plot&quot;</span>)</span>
<span id="cb545-22"><a href="association-between-categorical-variables.html#cb545-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-23"><a href="association-between-categorical-variables.html#cb545-23" aria-hidden="true" tabindex="-1"></a>female_15_task1yes_mosaic</span></code></pre></div>
<p><img src="_main_files/figure-html/chi_squared_yates_mosaic2-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>That’s another cool picture to show at your PI!</p>
</div>
<div id="chi-squared-test-without-correction" class="section level2 unnumbered">
<h2>Chi-Squared test without correction</h2>
<p>Finally, let’s see if there is any association between the age and the success on Task1 in untreated mice through Chi-Squared test. <br>
As always, here is the mosaic plot:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="association-between-categorical-variables.html#cb546-1" aria-hidden="true" tabindex="-1"></a>untreated_mosaic <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(untreated_df) <span class="sc">+</span></span>
<span id="cb546-2"><a href="association-between-categorical-variables.html#cb546-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(age), <span class="at">fill =</span> Task1), <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb546-3"><a href="association-between-categorical-variables.html#cb546-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb546-4"><a href="association-between-categorical-variables.html#cb546-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Task1 success rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb546-5"><a href="association-between-categorical-variables.html#cb546-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#76B041&quot;</span>, <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;#D9481C&quot;</span>)) <span class="sc">+</span></span>
<span id="cb546-6"><a href="association-between-categorical-variables.html#cb546-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb546-7"><a href="association-between-categorical-variables.html#cb546-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb546-8"><a href="association-between-categorical-variables.html#cb546-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.07</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb546-9"><a href="association-between-categorical-variables.html#cb546-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb546-10"><a href="association-between-categorical-variables.html#cb546-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-11"><a href="association-between-categorical-variables.html#cb546-11" aria-hidden="true" tabindex="-1"></a>untreated_mosaic</span></code></pre></div>
<p><img src="_main_files/figure-html/chi_squared_mosaic-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>It seems that the success rate in Task1 increases over time in untreated mice. Let’s see the contingency matrix and perform the test:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="association-between-categorical-variables.html#cb547-1" aria-hidden="true" tabindex="-1"></a>untreated_table</span></code></pre></div>
<pre class="code-out"><code>    
      1  0
  3  20 56
  7  39 35
  15 42 34
  30 69  5</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="association-between-categorical-variables.html#cb549-1" aria-hidden="true" tabindex="-1"></a>untreated_chisq_res <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(untreated_table, <span class="at">correct =</span> T)</span>
<span id="cb549-2"><a href="association-between-categorical-variables.html#cb549-2" aria-hidden="true" tabindex="-1"></a>untreated_chisq_res</span></code></pre></div>
<pre class="code-out"><code>
    Pearson&#39;s Chi-squared test

data:  untreated_table
X-squared = 69.362, df = 3, p-value = 5.846e-15</code></pre>
<p>From this test, it is evident that the association between age and success in Task1 is significant. Let’s quantify it.</p>
<div id="cramers-v" class="section level3 unnumbered">
<h3>Cramer’s V</h3>
<p>For contingency matrix that are bigger than 2x2 we cannot use Phi Coefficient to calculate the association, but we have to use <strong>Cramer’s V</strong>. The possible values are the same as Phi, and also the interpretation. To calculate it, the function is the same as for Phi, but here we take the value of Cramer’s V.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="association-between-categorical-variables.html#cb551-1" aria-hidden="true" tabindex="-1"></a>untreated_cramer <span class="ot">&lt;-</span> <span class="fu">assocstats</span>(untreated_table)<span class="sc">$</span>cramer</span>
<span id="cb551-2"><a href="association-between-categorical-variables.html#cb551-2" aria-hidden="true" tabindex="-1"></a>untreated_cramer</span></code></pre></div>
<pre class="code-out"><code>[1] 0.4808398</code></pre>
<p>There is quite a good positive association also here!</p>
<p>Let’s update our plot:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="association-between-categorical-variables.html#cb553-1" aria-hidden="true" tabindex="-1"></a>n_3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(untreated_df<span class="sc">$</span>age <span class="sc">==</span> <span class="dv">3</span>)</span>
<span id="cb553-2"><a href="association-between-categorical-variables.html#cb553-2" aria-hidden="true" tabindex="-1"></a>n_7 <span class="ot">&lt;-</span> <span class="fu">sum</span>(untreated_df<span class="sc">$</span>age <span class="sc">==</span> <span class="dv">7</span>)</span>
<span id="cb553-3"><a href="association-between-categorical-variables.html#cb553-3" aria-hidden="true" tabindex="-1"></a>n_15 <span class="ot">&lt;-</span> <span class="fu">sum</span>(untreated_df<span class="sc">$</span>age <span class="sc">==</span> <span class="dv">15</span>)</span>
<span id="cb553-4"><a href="association-between-categorical-variables.html#cb553-4" aria-hidden="true" tabindex="-1"></a>n_30 <span class="ot">&lt;-</span> <span class="fu">sum</span>(untreated_df<span class="sc">$</span>age <span class="sc">==</span> <span class="dv">30</span>)</span>
<span id="cb553-5"><a href="association-between-categorical-variables.html#cb553-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-6"><a href="association-between-categorical-variables.html#cb553-6" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">case_when</span>(untreated_chisq_res<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="fu">as.character</span>(<span class="fu">round</span>(untreated_chisq_res<span class="sc">$</span>p.value, <span class="dv">3</span>)),</span>
<span id="cb553-7"><a href="association-between-categorical-variables.html#cb553-7" aria-hidden="true" tabindex="-1"></a>                    untreated_chisq_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.0001</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.0001&quot;</span>,</span>
<span id="cb553-8"><a href="association-between-categorical-variables.html#cb553-8" aria-hidden="true" tabindex="-1"></a>                    untreated_chisq_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.001&quot;</span>,</span>
<span id="cb553-9"><a href="association-between-categorical-variables.html#cb553-9" aria-hidden="true" tabindex="-1"></a>                    untreated_chisq_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.01&quot;</span>,</span>
<span id="cb553-10"><a href="association-between-categorical-variables.html#cb553-10" aria-hidden="true" tabindex="-1"></a>                    untreated_chisq_res<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;&lt; 0.05&quot;</span>,</span>
<span id="cb553-11"><a href="association-between-categorical-variables.html#cb553-11" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb553-12"><a href="association-between-categorical-variables.html#cb553-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-13"><a href="association-between-categorical-variables.html#cb553-13" aria-hidden="true" tabindex="-1"></a>caption <span class="ot">&lt;-</span>  <span class="fu">paste0</span>(<span class="st">&quot;Task1 success rate (1: success; 0: fail) of untreated mice (n = &quot;</span>,</span>
<span id="cb553-14"><a href="association-between-categorical-variables.html#cb553-14" aria-hidden="true" tabindex="-1"></a>                   untreated_sample_size, <span class="st">&quot;), over time (P3 n = &quot;</span>, </span>
<span id="cb553-15"><a href="association-between-categorical-variables.html#cb553-15" aria-hidden="true" tabindex="-1"></a>                   n_3, <span class="st">&quot;, P7 n = &quot;</span>, n_7, <span class="st">&quot;, P15 n = &quot;</span>, n_15, <span class="st">&quot;, P30 n = &quot;</span>, n_30,</span>
<span id="cb553-16"><a href="association-between-categorical-variables.html#cb553-16" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;). Statistics calculated through Fisher&#39;s exact test.&quot;</span>)</span>
<span id="cb553-17"><a href="association-between-categorical-variables.html#cb553-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-18"><a href="association-between-categorical-variables.html#cb553-18" aria-hidden="true" tabindex="-1"></a>untreated_mosaic <span class="ot">&lt;-</span> untreated_mosaic <span class="sc">+</span></span>
<span id="cb553-19"><a href="association-between-categorical-variables.html#cb553-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;Cramer&#39;s V: &quot;</span>, <span class="fu">round</span>(untreated_cramer, <span class="dv">3</span>),</span>
<span id="cb553-20"><a href="association-between-categorical-variables.html#cb553-20" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;, p-value: &quot;</span>, pvalue), </span>
<span id="cb553-21"><a href="association-between-categorical-variables.html#cb553-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">str_wrap</span>(caption, <span class="at">width =</span> <span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb553-22"><a href="association-between-categorical-variables.html#cb553-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.07</span>),</span>
<span id="cb553-23"><a href="association-between-categorical-variables.html#cb553-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">debug =</span> F, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span> <span class="dv">20</span>)),</span>
<span id="cb553-24"><a href="association-between-categorical-variables.html#cb553-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption.position =</span> <span class="st">&quot;plot&quot;</span>)</span>
<span id="cb553-25"><a href="association-between-categorical-variables.html#cb553-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-26"><a href="association-between-categorical-variables.html#cb553-26" aria-hidden="true" tabindex="-1"></a>untreated_mosaic</span></code></pre></div>
<p><img src="_main_files/figure-html/chi_squared_mosaic2-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>Amazing, we have ansewred all the questions through these 3 test. Now you are able to use them in your personal analysis!</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro-stat-chapter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparing-two-groups.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
