<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>17 Comparing two groups | Learn R for biologist</title>
  <meta name="description" content="To you, who never gives up, for your future. You can make it!" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="17 Comparing two groups | Learn R for biologist" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="To you, who never gives up, for your future. You can make it!" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="17 Comparing two groups | Learn R for biologist" />
  
  <meta name="twitter:description" content="To you, who never gives up, for your future. You can make it!" />
  

<meta name="author" content="Matteo Miotto" />


<meta name="date" content="2023-10-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="association-between-categorical-variables.html"/>
<link rel="next" href="comparing-more-groups.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for biologist</a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1</b> Installation</a></li>
<li class="chapter" data-level="2" data-path="first-step-in-rstudio.html"><a href="first-step-in-rstudio.html"><i class="fa fa-check"></i><b>2</b> First step in RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="first-step-in-rstudio.html"><a href="first-step-in-rstudio.html#console"><i class="fa fa-check"></i>Console</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="variables.html"><a href="variables.html"><i class="fa fa-check"></i><b>3</b> Variables</a>
<ul>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html#create-a-variable"><i class="fa fa-check"></i>Create a variable</a></li>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html#use-a-variable"><i class="fa fa-check"></i>Use a variable</a></li>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html#variable-names"><i class="fa fa-check"></i>Variable names</a></li>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html#overwriting-variables"><i class="fa fa-check"></i>Overwriting variables</a></li>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html#list-all-variables"><i class="fa fa-check"></i>List all variables</a></li>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html#delete-variables"><i class="fa fa-check"></i>Delete variables</a></li>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html#type-of-variables"><i class="fa fa-check"></i>Type of variables</a></li>
<li class="chapter" data-level="" data-path="variables.html"><a href="variables.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="scripts-chapter.html"><a href="scripts-chapter.html"><i class="fa fa-check"></i><b>4</b> Scripts</a>
<ul>
<li class="chapter" data-level="" data-path="scripts-chapter.html"><a href="scripts-chapter.html#save"><i class="fa fa-check"></i>Save</a></li>
<li class="chapter" data-level="" data-path="scripts-chapter.html"><a href="scripts-chapter.html#source-a-script"><i class="fa fa-check"></i>Source a script</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="numbers.html"><a href="numbers.html"><i class="fa fa-check"></i><b>5</b> Numbers</a>
<ul>
<li class="chapter" data-level="" data-path="numbers.html"><a href="numbers.html#operations"><i class="fa fa-check"></i>Operations</a></li>
<li class="chapter" data-level="" data-path="numbers.html"><a href="numbers.html#rounding"><i class="fa fa-check"></i>Rounding</a></li>
<li class="chapter" data-level="" data-path="numbers.html"><a href="numbers.html#tranform-to-type-number"><i class="fa fa-check"></i>Tranform to type number</a></li>
<li class="chapter" data-level="" data-path="numbers.html"><a href="numbers.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="character.html"><a href="character.html"><i class="fa fa-check"></i><b>6</b> Character</a>
<ul>
<li class="chapter" data-level="" data-path="character.html"><a href="character.html#concatenate-strings"><i class="fa fa-check"></i>Concatenate strings</a></li>
<li class="chapter" data-level="" data-path="character.html"><a href="character.html#substring"><i class="fa fa-check"></i>Substring</a></li>
<li class="chapter" data-level="" data-path="character.html"><a href="character.html#substitution"><i class="fa fa-check"></i>Substitution</a></li>
<li class="chapter" data-level="" data-path="character.html"><a href="character.html#grep"><i class="fa fa-check"></i>Grep</a></li>
<li class="chapter" data-level="" data-path="character.html"><a href="character.html#transform-to-type-character"><i class="fa fa-check"></i>Transform to type character</a></li>
<li class="chapter" data-level="" data-path="character.html"><a href="character.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="boolean-chapter.html"><a href="boolean-chapter.html"><i class="fa fa-check"></i><b>7</b> Boolean</a>
<ul>
<li class="chapter" data-level="" data-path="boolean-chapter.html"><a href="boolean-chapter.html#boolean-as-results-of-comparison"><i class="fa fa-check"></i>Boolean as results of comparison</a></li>
<li class="chapter" data-level="" data-path="boolean-chapter.html"><a href="boolean-chapter.html#logical-operator"><i class="fa fa-check"></i>Logical operator</a>
<ul>
<li class="chapter" data-level="" data-path="boolean-chapter.html"><a href="boolean-chapter.html#and"><i class="fa fa-check"></i>AND</a></li>
<li class="chapter" data-level="" data-path="boolean-chapter.html"><a href="boolean-chapter.html#or"><i class="fa fa-check"></i>OR</a></li>
<li class="chapter" data-level="" data-path="boolean-chapter.html"><a href="boolean-chapter.html#not"><i class="fa fa-check"></i>NOT</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="boolean-chapter.html"><a href="boolean-chapter.html#exercises-3"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>8</b> Vectors</a>
<ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#named-vectors"><i class="fa fa-check"></i>Named vectors</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#indexing"><i class="fa fa-check"></i>Indexing</a>
<ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#named-vectors-1"><i class="fa fa-check"></i>Named vectors</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#slicing-vectors"><i class="fa fa-check"></i>Slicing</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#using-logicals"><i class="fa fa-check"></i>Using logicals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#one-function-can-be-applied-to-all-elements"><i class="fa fa-check"></i>One function can be applied to all elements</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#functions-specific-of-vectors"><i class="fa fa-check"></i>Functions specific of vectors</a>
<ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#sorting-a-vector"><i class="fa fa-check"></i>Sorting a vector</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#unique-values"><i class="fa fa-check"></i>Unique values</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#logical-vectors-sum-and-mean"><i class="fa fa-check"></i>Logical vectors sum and mean</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#operations-between-vectors"><i class="fa fa-check"></i>Operations between vectors</a>
<ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#mathematical"><i class="fa fa-check"></i>Mathematical</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#different-and-common-elements"><i class="fa fa-check"></i>Different and common elements</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#in"><i class="fa fa-check"></i>%in%</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#match"><i class="fa fa-check"></i>Match</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#exercises-4"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="matrices.html"><a href="matrices.html"><i class="fa fa-check"></i><b>9</b> Matrices</a>
<ul>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#create-a-matrix"><i class="fa fa-check"></i>Create a matrix</a>
<ul>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#binding"><i class="fa fa-check"></i>Binding</a></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#transform-into-a-matrix"><i class="fa fa-check"></i>Transform into a matrix</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#rownames-and-colnames"><i class="fa fa-check"></i>Rownames and colnames</a>
<ul>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#set-and-edit-row-and-column-names"><i class="fa fa-check"></i>Set and edit row and column names</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#indexing-matrices"><i class="fa fa-check"></i>Indexing</a>
<ul>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#slicing"><i class="fa fa-check"></i>Slicing</a></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#using-names"><i class="fa fa-check"></i>Using names</a></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#using-logicals-1"><i class="fa fa-check"></i>Using logicals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#functions-for-all-matrix"><i class="fa fa-check"></i>Functions for all matrix</a>
<ul>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#head-tail-matrices"><i class="fa fa-check"></i>Head/Tail</a></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#dim-nrow-ncol"><i class="fa fa-check"></i>Dim, nrow, ncol</a></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#summary-and-transpose"><i class="fa fa-check"></i>Summary and transpose</a></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#sum-max-min"><i class="fa fa-check"></i>Sum, Max, Min, …</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#apply-a-function-to-all-rows-or-columns"><i class="fa fa-check"></i>Apply a function to all rows or columns</a></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#exercises-5"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>10</b> Data frames</a>
<ul>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#create-a-data.frame"><i class="fa fa-check"></i>Create a data.frame</a>
<ul>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#from-matrix"><i class="fa fa-check"></i>From matrix</a></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#from-vectors"><i class="fa fa-check"></i>From vectors</a></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#from-file"><i class="fa fa-check"></i>From file</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#indexing-1"><i class="fa fa-check"></i>Indexing</a></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#create-a-new-column"><i class="fa fa-check"></i>Create a new column</a></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#delete-a-column"><i class="fa fa-check"></i>Delete a column</a></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#export-a-data-frame"><i class="fa fa-check"></i>Export a data frame</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="functions-packages-and-reproducibility.html"><a href="functions-packages-and-reproducibility.html"><i class="fa fa-check"></i><b>11</b> Functions, packages and reproducibility</a>
<ul>
<li class="chapter" data-level="" data-path="functions-packages-and-reproducibility.html"><a href="functions-packages-and-reproducibility.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="functions-packages-and-reproducibility.html"><a href="functions-packages-and-reproducibility.html#packages"><i class="fa fa-check"></i>Packages</a>
<ul>
<li class="chapter" data-level="" data-path="functions-packages-and-reproducibility.html"><a href="functions-packages-and-reproducibility.html#install-a-package"><i class="fa fa-check"></i>Install a package</a></li>
<li class="chapter" data-level="" data-path="functions-packages-and-reproducibility.html"><a href="functions-packages-and-reproducibility.html#load-a-package"><i class="fa fa-check"></i>Load a package</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="functions-packages-and-reproducibility.html"><a href="functions-packages-and-reproducibility.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a>
<ul>
<li class="chapter" data-level="" data-path="functions-packages-and-reproducibility.html"><a href="functions-packages-and-reproducibility.html#control-package-versions"><i class="fa fa-check"></i>Control package versions</a></li>
<li class="chapter" data-level="" data-path="functions-packages-and-reproducibility.html"><a href="functions-packages-and-reproducibility.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html"><i class="fa fa-check"></i><b>12</b> Manage data with tidyverse</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#r-notebook"><i class="fa fa-check"></i>R notebook</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#load-packages-and-data"><i class="fa fa-check"></i>Load packages and data</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#dataset-structure"><i class="fa fa-check"></i>Dataset structure</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#change-column-type"><i class="fa fa-check"></i>Change column type</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#reorder-levels-of-a-factor"><i class="fa fa-check"></i>Reorder levels of a factor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#summary"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#dealing-with-missing-values"><i class="fa fa-check"></i>Dealing with missing values</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#filter-a-dataframe"><i class="fa fa-check"></i>Filter a dataframe</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#sort-for-the-value-of-a-column"><i class="fa fa-check"></i>Sort for the value of a column</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#merge-two-columns"><i class="fa fa-check"></i>Merge two columns</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#split-two-columns"><i class="fa fa-check"></i>Split two columns</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#merge-two-dataframes"><i class="fa fa-check"></i>Merge two dataframes</a></li>
<li class="chapter" data-level="" data-path="tidyverse-manage.html"><a href="tidyverse-manage.html#exercises-6"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="aggregate-data-with-tidyverse.html"><a href="aggregate-data-with-tidyverse.html"><i class="fa fa-check"></i><b>13</b> Aggregate data with tidyverse</a>
<ul>
<li class="chapter" data-level="" data-path="aggregate-data-with-tidyverse.html"><a href="aggregate-data-with-tidyverse.html#table"><i class="fa fa-check"></i>Table</a></li>
<li class="chapter" data-level="" data-path="aggregate-data-with-tidyverse.html"><a href="aggregate-data-with-tidyverse.html#group-by-variables-and-summarize-values-of-another"><i class="fa fa-check"></i>Group by variables and summarize values of another</a></li>
<li class="chapter" data-level="" data-path="aggregate-data-with-tidyverse.html"><a href="aggregate-data-with-tidyverse.html#expand-dataframe-column-using-pivot-wider"><i class="fa fa-check"></i>Expand dataframe column using pivot wider</a></li>
<li class="chapter" data-level="" data-path="aggregate-data-with-tidyverse.html"><a href="aggregate-data-with-tidyverse.html#reshape-a-dataframe-with-pivot_longer"><i class="fa fa-check"></i>Reshape a dataframe with pivot_longer</a></li>
<li class="chapter" data-level="" data-path="aggregate-data-with-tidyverse.html"><a href="aggregate-data-with-tidyverse.html#exercises-7"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html"><i class="fa fa-check"></i><b>14</b> Plot our data with ggplot2</a>
<ul>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#command-structure"><i class="fa fa-check"></i>Command structure</a></li>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#type-of-graph-geom_-and-stat_"><i class="fa fa-check"></i>Type of graph (geom_ and stat_)</a>
<ul>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#mapping-values-to-graph-elements-aes"><i class="fa fa-check"></i>Mapping values to graph elements (aes)</a></li>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#change-the-stat-associated-to-the-graph"><i class="fa fa-check"></i>Change the “stat” associated to the graph</a></li>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#multiple-geometries-in-the-same-plot"><i class="fa fa-check"></i>Multiple geometries in the same plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#change-axis-and-colors-scale_"><i class="fa fa-check"></i>Change axis and colors (scale_)</a></li>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#add-title-and-change-labels-labs"><i class="fa fa-check"></i>Add title and change labels (labs)</a></li>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#change-appearence-theme"><i class="fa fa-check"></i>Change appearence (theme)</a></li>
<li class="chapter" data-level="" data-path="plot-our-data-with-ggplot2.html"><a href="plot-our-data-with-ggplot2.html#save-plot"><i class="fa fa-check"></i>Save plot</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="intro-stat-chapter.html"><a href="intro-stat-chapter.html"><i class="fa fa-check"></i><b>15</b> Introduction to statistics in R</a>
<ul>
<li class="chapter" data-level="" data-path="intro-stat-chapter.html"><a href="intro-stat-chapter.html#evaluate-parametric-assumptions"><i class="fa fa-check"></i>Evaluate parametric assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="intro-stat-chapter.html"><a href="intro-stat-chapter.html#visual-inspection"><i class="fa fa-check"></i>Visual inspection</a></li>
<li class="chapter" data-level="" data-path="intro-stat-chapter.html"><a href="intro-stat-chapter.html#no-outliers"><i class="fa fa-check"></i>No outliers</a></li>
<li class="chapter" data-level="" data-path="intro-stat-chapter.html"><a href="intro-stat-chapter.html#normality"><i class="fa fa-check"></i>Normality</a>
<ul>
<li class="chapter" data-level="" data-path="intro-stat-chapter.html"><a href="intro-stat-chapter.html#shapiro-wilk-normality-test"><i class="fa fa-check"></i>Shapiro-Wilk normality test</a></li>
<li class="chapter" data-level="" data-path="intro-stat-chapter.html"><a href="intro-stat-chapter.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i>Kolmogorov-Smirnov test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro-stat-chapter.html"><a href="intro-stat-chapter.html#homogeneity-of-variances-homoschedaticity"><i class="fa fa-check"></i>Homogeneity of variances (homoschedaticity)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="association-between-categorical-variables.html"><a href="association-between-categorical-variables.html"><i class="fa fa-check"></i><b>16</b> Association between categorical variables</a>
<ul>
<li class="chapter" data-level="" data-path="association-between-categorical-variables.html"><a href="association-between-categorical-variables.html#fisher-exact-test"><i class="fa fa-check"></i>Fisher exact test</a>
<ul>
<li class="chapter" data-level="" data-path="association-between-categorical-variables.html"><a href="association-between-categorical-variables.html#phi-φ-coefficient"><i class="fa fa-check"></i>Phi (φ) Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="association-between-categorical-variables.html"><a href="association-between-categorical-variables.html#chi-squared-test-with-yates-correction"><i class="fa fa-check"></i>Chi-Squared test with Yates correction</a></li>
<li class="chapter" data-level="" data-path="association-between-categorical-variables.html"><a href="association-between-categorical-variables.html#chi-squared-test-without-correction"><i class="fa fa-check"></i>Chi-Squared test without correction</a>
<ul>
<li class="chapter" data-level="" data-path="association-between-categorical-variables.html"><a href="association-between-categorical-variables.html#cramers-v"><i class="fa fa-check"></i>Cramer’s V</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="comparing-two-groups.html"><a href="comparing-two-groups.html"><i class="fa fa-check"></i><b>17</b> Comparing two groups</a>
<ul>
<li class="chapter" data-level="" data-path="comparing-two-groups.html"><a href="comparing-two-groups.html#t-test"><i class="fa fa-check"></i>T-test</a></li>
<li class="chapter" data-level="" data-path="comparing-two-groups.html"><a href="comparing-two-groups.html#welchs-test"><i class="fa fa-check"></i>Welch’s test</a></li>
<li class="chapter" data-level="" data-path="comparing-two-groups.html"><a href="comparing-two-groups.html#mann-whitney-and-wilcoxon"><i class="fa fa-check"></i>Mann-Whitney and Wilcoxon</a></li>
<li class="chapter" data-level="" data-path="comparing-two-groups.html"><a href="comparing-two-groups.html#add-values-to-graph"><i class="fa fa-check"></i>Add values to graph</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="comparing-more-groups.html"><a href="comparing-more-groups.html"><i class="fa fa-check"></i><b>18</b> Comparing more groups</a>
<ul>
<li class="chapter" data-level="" data-path="comparing-more-groups.html"><a href="comparing-more-groups.html#anova"><i class="fa fa-check"></i>ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="comparing-more-groups.html"><a href="comparing-more-groups.html#post-hoc-test"><i class="fa fa-check"></i>Post-hoc test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="comparing-more-groups.html"><a href="comparing-more-groups.html#kruskal-wallis"><i class="fa fa-check"></i>Kruskal Wallis</a>
<ul>
<li class="chapter" data-level="" data-path="comparing-more-groups.html"><a href="comparing-more-groups.html#post-hoc-test-1"><i class="fa fa-check"></i>Post-hoc test</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learn R for biologist</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="comparing-two-groups" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">17</span> Comparing two groups<a href="comparing-two-groups.html#comparing-two-groups" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Another chapter, another test(s). Here, we will see how to compare two groups with continuous values: t test and Welch’s t-test (parametric data) and Wilkoxon and Mann-Whitney (non-parametric data).<br>
We have already seen how to decide whether to use parametric and non-parametric tests (if you don’t remember, go and check the Intro to statistics <a href="intro-stat-chapter.html#intro-stat-chapter">chapter</a>), so let’s start by loading our data and decide what we want to compare.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="comparing-two-groups.html#cb554-1" tabindex="-1"></a><span class="co"># 1. Load packages </span></span>
<span id="cb554-2"><a href="comparing-two-groups.html#cb554-2" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb554-3"><a href="comparing-two-groups.html#cb554-3" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(ggplot2))</span>
<span id="cb554-4"><a href="comparing-two-groups.html#cb554-4" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(ggpubr))</span>
<span id="cb554-5"><a href="comparing-two-groups.html#cb554-5" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(gginnards))</span>
<span id="cb554-6"><a href="comparing-two-groups.html#cb554-6" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(glue))</span>
<span id="cb554-7"><a href="comparing-two-groups.html#cb554-7" tabindex="-1"></a></span>
<span id="cb554-8"><a href="comparing-two-groups.html#cb554-8" tabindex="-1"></a><span class="co"># 2. Load data</span></span>
<span id="cb554-9"><a href="comparing-two-groups.html#cb554-9" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/Stat-test-dataset.csv&quot;</span>)</span>
<span id="cb554-10"><a href="comparing-two-groups.html#cb554-10" tabindex="-1"></a></span>
<span id="cb554-11"><a href="comparing-two-groups.html#cb554-11" tabindex="-1"></a><span class="co"># 3. Change come column types</span></span>
<span id="cb554-12"><a href="comparing-two-groups.html#cb554-12" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb554-13"><a href="comparing-two-groups.html#cb554-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;sex&quot;</span> <span class="ot">=</span> <span class="fu">factor</span>(sex),</span>
<span id="cb554-14"><a href="comparing-two-groups.html#cb554-14" tabindex="-1"></a>         <span class="st">&quot;treatment&quot;</span> <span class="ot">=</span> <span class="fu">factor</span>(treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;T1&quot;</span>, <span class="st">&quot;Untreated&quot;</span>)),</span>
<span id="cb554-15"><a href="comparing-two-groups.html#cb554-15" tabindex="-1"></a>         <span class="st">&quot;Task1&quot;</span> <span class="ot">=</span> <span class="fu">factor</span>(Task1, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb554-16"><a href="comparing-two-groups.html#cb554-16" tabindex="-1"></a>         <span class="st">&quot;Task2&quot;</span> <span class="ot">=</span> <span class="fu">factor</span>(Task2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb554-17"><a href="comparing-two-groups.html#cb554-17" tabindex="-1"></a>         )</span>
<span id="cb554-18"><a href="comparing-two-groups.html#cb554-18" tabindex="-1"></a></span>
<span id="cb554-19"><a href="comparing-two-groups.html#cb554-19" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<pre class="code-out"><code>&#39;data.frame&#39;:   600 obs. of  7 variables:
 $ sex      : Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 2 1 2 1 2 1 2 1 2 1 ...
 $ age      : int  3 3 3 3 3 3 3 3 3 3 ...
 $ treatment: Factor w/ 2 levels &quot;T1&quot;,&quot;Untreated&quot;: 2 2 1 1 2 2 1 1 2 2 ...
 $ weight   : num  6.43 3.42 4.97 4.63 7.31 3.27 5.58 3.27 5.9 4.22 ...
 $ Task1    : Factor w/ 2 levels &quot;1&quot;,&quot;0&quot;: 1 2 2 2 1 1 1 1 2 1 ...
 $ Task2    : Factor w/ 2 levels &quot;1&quot;,&quot;0&quot;: 1 2 2 1 1 2 2 1 1 1 ...
 $ Task3    : num  222.4 202.3 36.7 221.8 178.8 ...</code></pre>
<p class="plist">
Now that we have our data loaded, there are the question we want to address:
</p>
<ol>
<li>
Do untreated females at P30 weight more than the ones at P15?
</li>
<li>
At P3, is there a difference in weight in T1-treated mice between males and females?
</li>
<li>
Do P30 males behave differently in Task3 based on treatment?
</li>
</ol>
<p>Let’s now decide which test to use for each question. We can start by looking at the boxplots and then check parametric assumptions (it’s important to do so!).<br> But first, we have to subset our dataframe:</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="comparing-two-groups.html#cb556-1" tabindex="-1"></a><span class="co"># 1. Filter data</span></span>
<span id="cb556-2"><a href="comparing-two-groups.html#cb556-2" tabindex="-1"></a>female_t1_weight_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb556-3"><a href="comparing-two-groups.html#cb556-3" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">30</span>) <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">&quot;Female&quot;</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">&quot;T1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb556-4"><a href="comparing-two-groups.html#cb556-4" tabindex="-1"></a>  <span class="fu">select</span>(sex, age, treatment, weight) <span class="sc">%&gt;%</span></span>
<span id="cb556-5"><a href="comparing-two-groups.html#cb556-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">factor</span>(age))</span>
<span id="cb556-6"><a href="comparing-two-groups.html#cb556-6" tabindex="-1"></a></span>
<span id="cb556-7"><a href="comparing-two-groups.html#cb556-7" tabindex="-1"></a>t1_3_weight_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb556-8"><a href="comparing-two-groups.html#cb556-8" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">&quot;T1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb556-9"><a href="comparing-two-groups.html#cb556-9" tabindex="-1"></a>  <span class="fu">select</span>(sex, age, treatment, weight)</span>
<span id="cb556-10"><a href="comparing-two-groups.html#cb556-10" tabindex="-1"></a></span>
<span id="cb556-11"><a href="comparing-two-groups.html#cb556-11" tabindex="-1"></a>male_3_task3_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb556-12"><a href="comparing-two-groups.html#cb556-12" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb556-13"><a href="comparing-two-groups.html#cb556-13" tabindex="-1"></a>  <span class="fu">select</span>(sex, age, treatment, Task3)</span></code></pre></div>
<p>Then, we will look at the boxplot:</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="comparing-two-groups.html#cb557-1" tabindex="-1"></a>female_t1_weight_boxplot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(female_t1_weight_df) <span class="sc">+</span></span>
<span id="cb557-2"><a href="comparing-two-groups.html#cb557-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> weight, <span class="at">fill =</span> age, <span class="at">group =</span> age)) <span class="sc">+</span></span>
<span id="cb557-3"><a href="comparing-two-groups.html#cb557-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Weight (g)&quot;</span>, <span class="at">title =</span> <span class="st">&quot;T1-treated females weight&quot;</span>) <span class="sc">+</span></span>
<span id="cb557-4"><a href="comparing-two-groups.html#cb557-4" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb557-5"><a href="comparing-two-groups.html#cb557-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb557-6"><a href="comparing-two-groups.html#cb557-6" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb557-7"><a href="comparing-two-groups.html#cb557-7" tabindex="-1"></a></span>
<span id="cb557-8"><a href="comparing-two-groups.html#cb557-8" tabindex="-1"></a>t1_3_weight_boxplot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(t1_3_weight_df) <span class="sc">+</span></span>
<span id="cb557-9"><a href="comparing-two-groups.html#cb557-9" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">y =</span> weight, <span class="at">fill =</span> sex, <span class="at">group =</span> sex)) <span class="sc">+</span></span>
<span id="cb557-10"><a href="comparing-two-groups.html#cb557-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Sex&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Weight (g)&quot;</span>, <span class="at">title =</span> <span class="st">&quot;T1-treated P3 weight&quot;</span>) <span class="sc">+</span></span>
<span id="cb557-11"><a href="comparing-two-groups.html#cb557-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb557-12"><a href="comparing-two-groups.html#cb557-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb557-13"><a href="comparing-two-groups.html#cb557-13" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb557-14"><a href="comparing-two-groups.html#cb557-14" tabindex="-1"></a></span>
<span id="cb557-15"><a href="comparing-two-groups.html#cb557-15" tabindex="-1"></a>male_3_task3_boxplot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(male_3_task3_df) <span class="sc">+</span></span>
<span id="cb557-16"><a href="comparing-two-groups.html#cb557-16" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> Task3, <span class="at">fill =</span> treatment, <span class="at">group =</span> treatment)) <span class="sc">+</span></span>
<span id="cb557-17"><a href="comparing-two-groups.html#cb557-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Task3 (s)&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Male P3 Task3&quot;</span>) <span class="sc">+</span></span>
<span id="cb557-18"><a href="comparing-two-groups.html#cb557-18" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb557-19"><a href="comparing-two-groups.html#cb557-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb557-20"><a href="comparing-two-groups.html#cb557-20" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb557-21"><a href="comparing-two-groups.html#cb557-21" tabindex="-1"></a></span>
<span id="cb557-22"><a href="comparing-two-groups.html#cb557-22" tabindex="-1"></a><span class="fu">ggarrange</span>(female_t1_weight_boxplot, t1_3_weight_boxplot, male_3_task3_boxplot, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/two_groups_boxplot-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>Great, we can see some differences. And yes, there are some outliers in <b>B.</b>, but we do not want to remove them now, you can try it if you want (it can be a useful exercise).<br>
We now check the normality and homoschedasticity for each group, and then insert those info in the plot:</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="comparing-two-groups.html#cb558-1" tabindex="-1"></a><span class="co"># 1. Shapiro test</span></span>
<span id="cb558-2"><a href="comparing-two-groups.html#cb558-2" tabindex="-1"></a>female_t1_weight_shapiro <span class="ot">&lt;-</span> female_t1_weight_df <span class="sc">%&gt;%</span></span>
<span id="cb558-3"><a href="comparing-two-groups.html#cb558-3" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb558-4"><a href="comparing-two-groups.html#cb558-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">shap =</span> <span class="fu">shapiro.test</span>(weight)<span class="sc">$</span>p.value)</span>
<span id="cb558-5"><a href="comparing-two-groups.html#cb558-5" tabindex="-1"></a></span>
<span id="cb558-6"><a href="comparing-two-groups.html#cb558-6" tabindex="-1"></a>t1_3_weight_shapiro <span class="ot">&lt;-</span> t1_3_weight_df <span class="sc">%&gt;%</span></span>
<span id="cb558-7"><a href="comparing-two-groups.html#cb558-7" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb558-8"><a href="comparing-two-groups.html#cb558-8" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">shap =</span> <span class="fu">shapiro.test</span>(weight)<span class="sc">$</span>p.value)</span>
<span id="cb558-9"><a href="comparing-two-groups.html#cb558-9" tabindex="-1"></a></span>
<span id="cb558-10"><a href="comparing-two-groups.html#cb558-10" tabindex="-1"></a>male_3_task3_shapiro <span class="ot">&lt;-</span> male_3_task3_df <span class="sc">%&gt;%</span></span>
<span id="cb558-11"><a href="comparing-two-groups.html#cb558-11" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb558-12"><a href="comparing-two-groups.html#cb558-12" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">shap =</span> <span class="fu">shapiro.test</span>(Task3)<span class="sc">$</span>p.value)</span>
<span id="cb558-13"><a href="comparing-two-groups.html#cb558-13" tabindex="-1"></a></span>
<span id="cb558-14"><a href="comparing-two-groups.html#cb558-14" tabindex="-1"></a><span class="co"># 2. Bartlett test</span></span>
<span id="cb558-15"><a href="comparing-two-groups.html#cb558-15" tabindex="-1"></a>female_t1_weight_bartlett <span class="ot">&lt;-</span> <span class="fu">bartlett.test</span>(female_t1_weight_df<span class="sc">$</span>weight, female_t1_weight_df<span class="sc">$</span>age)<span class="sc">$</span>p.value</span>
<span id="cb558-16"><a href="comparing-two-groups.html#cb558-16" tabindex="-1"></a>t1_3_weight_bartlett <span class="ot">&lt;-</span> <span class="fu">bartlett.test</span>(t1_3_weight_df<span class="sc">$</span>weight, t1_3_weight_df<span class="sc">$</span>sex)<span class="sc">$</span>p.value</span>
<span id="cb558-17"><a href="comparing-two-groups.html#cb558-17" tabindex="-1"></a>male_3_task3_bartlett <span class="ot">&lt;-</span> <span class="fu">bartlett.test</span>(male_3_task3_df<span class="sc">$</span>Task3, male_3_task3_df<span class="sc">$</span>treatment)<span class="sc">$</span>p.value</span>
<span id="cb558-18"><a href="comparing-two-groups.html#cb558-18" tabindex="-1"></a></span>
<span id="cb558-19"><a href="comparing-two-groups.html#cb558-19" tabindex="-1"></a><span class="co"># 3. Get labels position</span></span>
<span id="cb558-20"><a href="comparing-two-groups.html#cb558-20" tabindex="-1"></a>female_t1_weight_max <span class="ot">&lt;-</span> <span class="fu">max</span>(female_t1_weight_df<span class="sc">$</span>weight, <span class="at">na.rm =</span> T) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb558-21"><a href="comparing-two-groups.html#cb558-21" tabindex="-1"></a>t1_3_weight_max <span class="ot">&lt;-</span> <span class="fu">max</span>(t1_3_weight_df<span class="sc">$</span>weight, <span class="at">na.rm =</span> T) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb558-22"><a href="comparing-two-groups.html#cb558-22" tabindex="-1"></a>male_3_task3_max <span class="ot">&lt;-</span> <span class="fu">max</span>(male_3_task3_df<span class="sc">$</span>Task3, <span class="at">na.rm =</span> T) <span class="sc">+</span> <span class="dv">20</span></span>
<span id="cb558-23"><a href="comparing-two-groups.html#cb558-23" tabindex="-1"></a></span>
<span id="cb558-24"><a href="comparing-two-groups.html#cb558-24" tabindex="-1"></a><span class="co"># 1. Create boxplots</span></span>
<span id="cb558-25"><a href="comparing-two-groups.html#cb558-25" tabindex="-1"></a>female_t1_weight_boxplot <span class="ot">&lt;-</span> female_t1_weight_boxplot <span class="sc">+</span></span>
<span id="cb558-26"><a href="comparing-two-groups.html#cb558-26" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> female_t1_weight_shapiro, </span>
<span id="cb558-27"><a href="comparing-two-groups.html#cb558-27" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age, </span>
<span id="cb558-28"><a href="comparing-two-groups.html#cb558-28" tabindex="-1"></a>                           <span class="at">y =</span> female_t1_weight_max, </span>
<span id="cb558-29"><a href="comparing-two-groups.html#cb558-29" tabindex="-1"></a>                           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Shapiro-Wilk</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">round</span>(shap, <span class="dv">3</span>)))</span>
<span id="cb558-30"><a href="comparing-two-groups.html#cb558-30" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb558-31"><a href="comparing-two-groups.html#cb558-31" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Bartlett test p-value:&quot;</span>, <span class="fu">round</span>(female_t1_weight_bartlett, <span class="dv">3</span>)))</span>
<span id="cb558-32"><a href="comparing-two-groups.html#cb558-32" tabindex="-1"></a></span>
<span id="cb558-33"><a href="comparing-two-groups.html#cb558-33" tabindex="-1"></a>t1_3_weight_boxplot <span class="ot">&lt;-</span> t1_3_weight_boxplot <span class="sc">+</span></span>
<span id="cb558-34"><a href="comparing-two-groups.html#cb558-34" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> t1_3_weight_shapiro, </span>
<span id="cb558-35"><a href="comparing-two-groups.html#cb558-35" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> sex, </span>
<span id="cb558-36"><a href="comparing-two-groups.html#cb558-36" tabindex="-1"></a>                           <span class="at">y =</span> t1_3_weight_max, </span>
<span id="cb558-37"><a href="comparing-two-groups.html#cb558-37" tabindex="-1"></a>                           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Shapiro-Wilk</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">round</span>(shap, <span class="dv">3</span>)))</span>
<span id="cb558-38"><a href="comparing-two-groups.html#cb558-38" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb558-39"><a href="comparing-two-groups.html#cb558-39" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Bartlett test p-value:&quot;</span>, <span class="fu">round</span>(t1_3_weight_bartlett, <span class="dv">3</span>)))</span>
<span id="cb558-40"><a href="comparing-two-groups.html#cb558-40" tabindex="-1"></a></span>
<span id="cb558-41"><a href="comparing-two-groups.html#cb558-41" tabindex="-1"></a>male_3_task3_boxplot <span class="ot">&lt;-</span> male_3_task3_boxplot <span class="sc">+</span></span>
<span id="cb558-42"><a href="comparing-two-groups.html#cb558-42" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> male_3_task3_shapiro, </span>
<span id="cb558-43"><a href="comparing-two-groups.html#cb558-43" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> treatment, </span>
<span id="cb558-44"><a href="comparing-two-groups.html#cb558-44" tabindex="-1"></a>                           <span class="at">y =</span> male_3_task3_max, </span>
<span id="cb558-45"><a href="comparing-two-groups.html#cb558-45" tabindex="-1"></a>                           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Shapiro-Wilk</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">round</span>(shap, <span class="dv">3</span>)))</span>
<span id="cb558-46"><a href="comparing-two-groups.html#cb558-46" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb558-47"><a href="comparing-two-groups.html#cb558-47" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Bartlett test p-value:&quot;</span>, <span class="fu">round</span>(male_3_task3_bartlett, <span class="dv">3</span>)))</span>
<span id="cb558-48"><a href="comparing-two-groups.html#cb558-48" tabindex="-1"></a></span>
<span id="cb558-49"><a href="comparing-two-groups.html#cb558-49" tabindex="-1"></a><span class="fu">ggarrange</span>(female_t1_weight_boxplot, t1_3_weight_boxplot, male_3_task3_boxplot, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/two_groups_boxplot2-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>Amazing! We have to use simple t-test in <b>A</b>, Welch’s t-test in <b>B</b> and Mann-Whitney test in <b>C</b>. Let’s see how to perform these tests in R.</p>
<div id="t-test" class="section level2 unnumbered hasAnchor">
<h2>T-test<a href="comparing-two-groups.html#t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
T-test is one of the most famous test and the one that most of people try to apply every time, even if it’s not possible (sigh, but after this course, I know you won’t be one of them).
<p class="plist">
You can use the t-test to compare:
</p>
<ul>
<li>
The mean of a sample and the expected mean of the population
</li>
<li>
The difference of the mean values of two dependent populations (paired t-test)
</li>
<li>
The difference of the mean values of two independent populations (unpaired t-test)
</li>
</ul>
<p>In our case, we want to evaluate whether the untreated females at P30 weight more than the ones at P15. As the samples are independent, we will use the unpaired t-test, but don’t worry, I will explain you all the possible scenarios and how to write the proper code.<br>
The function to use is <code>t.test()</code>, and there are plenty of cool arguments that we can use to apply the right test in the right conditions. Let’s look how we apply it in our case, and then explain each bit of code:</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="comparing-two-groups.html#cb559-1" tabindex="-1"></a>t_test_res <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">formula =</span> female_t1_weight_df<span class="sc">$</span>weight <span class="sc">~</span> female_t1_weight_df<span class="sc">$</span>age,</span>
<span id="cb559-2"><a href="comparing-two-groups.html#cb559-2" tabindex="-1"></a>                     <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>,</span>
<span id="cb559-3"><a href="comparing-two-groups.html#cb559-3" tabindex="-1"></a>                     <span class="at">mu =</span> <span class="dv">0</span>,</span>
<span id="cb559-4"><a href="comparing-two-groups.html#cb559-4" tabindex="-1"></a>                     <span class="at">paired =</span> F,</span>
<span id="cb559-5"><a href="comparing-two-groups.html#cb559-5" tabindex="-1"></a>                     <span class="at">var.equal =</span> T)</span></code></pre></div>
<p class="plist">
Wow, lots of things to explain:
</p>
<ul>
<li>
<em>formula</em>: you can provide a formula like <code>continuous ~ categorical</code>. The categorical varibale should have maximum 2 levels, and the comparison is made as 1st level vs. 2nd level (in our case, P15 over P30). This is not the only way you can give data to this function, you can also just provide two continuous vectors separated by a comma, without calling formula.
</li>
<li>
<em>alternative</em>: it indicates which is the alternative hypothesis (“two.sided” default, “less” or “more”). As we wanted to know if P30 females weight more that P15, and that the comparison was made P15 over P30, we used “less”.
</li>
<li>
<em>mu</em>: is the value of the difference we want to test (if two samples) or the mean (if one sample). We choose 0 in this case, but we could have written <code>-5</code> if we wanted to know if P30 females weight 5g more than P15 ones. Pay attention to the sign!
</li>
<li>
<em>paired</em>: TRUE (paired t-test) or FALSE (unpaired t-test, default). Remember that in paired t-test, the two samples must be of the same size
</li>
<li>
<em>var.equal</em>: TRUE (student t-test) or FALSE (Welch’s t-test, default). We wanted to use the student t-test as we tested that the variances of the two groups are the same.
</li>
</ul>
<p>And now, let’s see the results. Remember to store the results in a variable, so we can get all the values that we needed for further analysis/plots.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="comparing-two-groups.html#cb560-1" tabindex="-1"></a>t_test_res</span></code></pre></div>
<pre class="code-out"><code>
    Two Sample t-test

data:  female_t1_weight_df$weight by female_t1_weight_df$age
t = -47.074, df = 73, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group 15 and group 30 is less than 0
95 percent confidence interval:
      -Inf -7.279732
sample estimates:
mean in group 15 mean in group 30 
        9.310811        16.857632 </code></pre>
<p>We have a lot of information. I think that there is not much to say, as it is kind of self-explanatory, with type of test, p-value, confidence interval, alternative hypothesis and mean values.<br>
We can confirm that this is significant (as expected, otherwise females are not growing and that’s a problem).</p>
</div>
<div id="welchs-test" class="section level2 unnumbered hasAnchor">
<h2>Welch’s test<a href="comparing-two-groups.html#welchs-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To address the second question, we have to use Welch’s t-test, as the two samples have normal distributions, but different variances. We have just seen how to perform Welch’s t-test just by setting <code>var.equal = FALSE</code> in <code>t.test()</code> function. <br>
So, we talks are over, here is the answer to our question:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="comparing-two-groups.html#cb562-1" tabindex="-1"></a><span class="co"># 1. Perform the test</span></span>
<span id="cb562-2"><a href="comparing-two-groups.html#cb562-2" tabindex="-1"></a>welch_res <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">formula =</span> t1_3_weight_df<span class="sc">$</span>weight <span class="sc">~</span> t1_3_weight_df<span class="sc">$</span>sex,</span>
<span id="cb562-3"><a href="comparing-two-groups.html#cb562-3" tabindex="-1"></a>                     <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,</span>
<span id="cb562-4"><a href="comparing-two-groups.html#cb562-4" tabindex="-1"></a>                     <span class="at">mu =</span> <span class="dv">0</span>,</span>
<span id="cb562-5"><a href="comparing-two-groups.html#cb562-5" tabindex="-1"></a>                     <span class="at">paired =</span> F,</span>
<span id="cb562-6"><a href="comparing-two-groups.html#cb562-6" tabindex="-1"></a>                     <span class="at">var.equal =</span> F)</span>
<span id="cb562-7"><a href="comparing-two-groups.html#cb562-7" tabindex="-1"></a></span>
<span id="cb562-8"><a href="comparing-two-groups.html#cb562-8" tabindex="-1"></a><span class="co"># 2. Show the results</span></span>
<span id="cb562-9"><a href="comparing-two-groups.html#cb562-9" tabindex="-1"></a>welch_res</span></code></pre></div>
<pre class="code-out"><code>
    Welch Two Sample t-test

data:  t1_3_weight_df$weight by t1_3_weight_df$sex
t = -7.9115, df = 61.568, p-value = 5.889e-11
alternative hypothesis: true difference in means between group Female and group Male is not equal to 0
95 percent confidence interval:
 -2.313433 -1.380081
sample estimates:
mean in group Female   mean in group Male 
            3.556757             5.403514 </code></pre>
<p>And yes! There is difference between males and females at P3, with males that weight significantly more than females.</p>
</div>
<div id="mann-whitney-and-wilcoxon" class="section level2 unnumbered hasAnchor">
<h2>Mann-Whitney and Wilcoxon<a href="comparing-two-groups.html#mann-whitney-and-wilcoxon" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will now address the last question through Mann-Whitney test, which is the non-parametric analogous of the unpaired t-test (we will not cover the Wilcoxon, which is the non-parametric analogous of the paired t-test, but you will see now hot to perform it as well).<br>
The function we will use is <code>wilcox.test()</code>. Yeah, I know it sounds weird, but that’s it. It takes the same arguments as the parametric counterpart, so we won’t see them again. To notice, if we set <code>paired = T</code>, we will perform the Wilcoxon test, otherwise we will perform Mann-Whitney.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="comparing-two-groups.html#cb564-1" tabindex="-1"></a><span class="co"># 1. Perform the test</span></span>
<span id="cb564-2"><a href="comparing-two-groups.html#cb564-2" tabindex="-1"></a>mann_res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(<span class="at">formula =</span> male_3_task3_df<span class="sc">$</span>Task3 <span class="sc">~</span> male_3_task3_df<span class="sc">$</span>treatment,</span>
<span id="cb564-3"><a href="comparing-two-groups.html#cb564-3" tabindex="-1"></a>                     <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,</span>
<span id="cb564-4"><a href="comparing-two-groups.html#cb564-4" tabindex="-1"></a>                     <span class="at">mu =</span> <span class="dv">0</span>,</span>
<span id="cb564-5"><a href="comparing-two-groups.html#cb564-5" tabindex="-1"></a>                     <span class="at">paired =</span> F)</span>
<span id="cb564-6"><a href="comparing-two-groups.html#cb564-6" tabindex="-1"></a></span>
<span id="cb564-7"><a href="comparing-two-groups.html#cb564-7" tabindex="-1"></a><span class="co"># 2. Show the results</span></span>
<span id="cb564-8"><a href="comparing-two-groups.html#cb564-8" tabindex="-1"></a>mann_res</span></code></pre></div>
<pre class="code-out"><code>
    Wilcoxon rank sum test with continuity correction

data:  male_3_task3_df$Task3 by male_3_task3_df$treatment
W = 189, p-value = 5.277e-08
alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>The output is slightly different, but we still have p-value and alternative hypothesis.<br>
<strong>Remember</strong>: with non-parametric tests, you are not comparing the mean directly. That’s why here are not indicated.</p>
</div>
<div id="add-values-to-graph" class="section level2 unnumbered hasAnchor">
<h2>Add values to graph<a href="comparing-two-groups.html#add-values-to-graph" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can now add the results of the statistical tests to the previous plot; but first, we will use <em>gginnards</em> package to removes the shapiro test values on the plot, because we want to put statistics there, moving shapiro results in the plot description.<br>
I will now write the whole code, you have already seen much of this stuff; the only difference is that I will use <code>delete_layers()</code> to remove Shapiro results:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="comparing-two-groups.html#cb566-1" tabindex="-1"></a><span class="co"># 1. Remove shapiro results </span></span>
<span id="cb566-2"><a href="comparing-two-groups.html#cb566-2" tabindex="-1"></a>female_t1_weight_boxplot <span class="ot">&lt;-</span> <span class="fu">delete_layers</span>(female_t1_weight_boxplot, <span class="st">&quot;GeomText&quot;</span>)</span>
<span id="cb566-3"><a href="comparing-two-groups.html#cb566-3" tabindex="-1"></a>t1_3_weight_boxplot <span class="ot">&lt;-</span> <span class="fu">delete_layers</span>(t1_3_weight_boxplot, <span class="st">&quot;GeomText&quot;</span>)</span>
<span id="cb566-4"><a href="comparing-two-groups.html#cb566-4" tabindex="-1"></a>male_3_task3_boxplot <span class="ot">&lt;-</span> <span class="fu">delete_layers</span>(male_3_task3_boxplot, <span class="st">&quot;GeomText&quot;</span>)</span>
<span id="cb566-5"><a href="comparing-two-groups.html#cb566-5" tabindex="-1"></a></span>
<span id="cb566-6"><a href="comparing-two-groups.html#cb566-6" tabindex="-1"></a><span class="co"># 2. Create a function to map *, **, *** and ns to statistics</span></span>
<span id="cb566-7"><a href="comparing-two-groups.html#cb566-7" tabindex="-1"></a>pvalue_to_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb566-8"><a href="comparing-two-groups.html#cb566-8" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb566-9"><a href="comparing-two-groups.html#cb566-9" tabindex="-1"></a>    x <span class="sc">&lt;=</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;***&quot;</span>,</span>
<span id="cb566-10"><a href="comparing-two-groups.html#cb566-10" tabindex="-1"></a>    x <span class="sc">&lt;=</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;**&quot;</span>,</span>
<span id="cb566-11"><a href="comparing-two-groups.html#cb566-11" tabindex="-1"></a>    x <span class="sc">&lt;=</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;*&quot;</span>,</span>
<span id="cb566-12"><a href="comparing-two-groups.html#cb566-12" tabindex="-1"></a>    <span class="at">.default =</span> <span class="st">&quot;ns&quot;</span></span>
<span id="cb566-13"><a href="comparing-two-groups.html#cb566-13" tabindex="-1"></a>  )</span>
<span id="cb566-14"><a href="comparing-two-groups.html#cb566-14" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb566-15"><a href="comparing-two-groups.html#cb566-15" tabindex="-1"></a>}</span>
<span id="cb566-16"><a href="comparing-two-groups.html#cb566-16" tabindex="-1"></a></span>
<span id="cb566-17"><a href="comparing-two-groups.html#cb566-17" tabindex="-1"></a><span class="co"># 3. Add pvalues of statistics and remove Bartlett results</span></span>
<span id="cb566-18"><a href="comparing-two-groups.html#cb566-18" tabindex="-1"></a>female_t1_weight_boxplot <span class="ot">&lt;-</span> female_t1_weight_boxplot <span class="sc">+</span></span>
<span id="cb566-19"><a href="comparing-two-groups.html#cb566-19" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> female_t1_weight_max, <span class="at">xend =</span> <span class="dv">2</span>, <span class="at">yend =</span> female_t1_weight_max)) <span class="sc">+</span></span>
<span id="cb566-20"><a href="comparing-two-groups.html#cb566-20" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> female_t1_weight_max <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="fu">pvalue_to_plot</span>(t_test_res<span class="sc">$</span>p.value))) <span class="sc">+</span></span>
<span id="cb566-21"><a href="comparing-two-groups.html#cb566-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb566-22"><a href="comparing-two-groups.html#cb566-22" tabindex="-1"></a></span>
<span id="cb566-23"><a href="comparing-two-groups.html#cb566-23" tabindex="-1"></a>t1_3_weight_boxplot <span class="ot">&lt;-</span> t1_3_weight_boxplot <span class="sc">+</span></span>
<span id="cb566-24"><a href="comparing-two-groups.html#cb566-24" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> t1_3_weight_max, <span class="at">xend =</span> <span class="dv">2</span>, <span class="at">yend =</span> t1_3_weight_max)) <span class="sc">+</span></span>
<span id="cb566-25"><a href="comparing-two-groups.html#cb566-25" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> t1_3_weight_max <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="fu">pvalue_to_plot</span>(welch_res<span class="sc">$</span>p.value))) <span class="sc">+</span></span>
<span id="cb566-26"><a href="comparing-two-groups.html#cb566-26" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb566-27"><a href="comparing-two-groups.html#cb566-27" tabindex="-1"></a></span>
<span id="cb566-28"><a href="comparing-two-groups.html#cb566-28" tabindex="-1"></a>male_3_task3_boxplot <span class="ot">&lt;-</span> male_3_task3_boxplot <span class="sc">+</span></span>
<span id="cb566-29"><a href="comparing-two-groups.html#cb566-29" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> male_3_task3_max, <span class="at">xend =</span> <span class="dv">2</span>, <span class="at">yend =</span> male_3_task3_max)) <span class="sc">+</span></span>
<span id="cb566-30"><a href="comparing-two-groups.html#cb566-30" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> male_3_task3_max <span class="sc">+</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="fu">pvalue_to_plot</span>(mann_res<span class="sc">$</span>p.value))) <span class="sc">+</span></span>
<span id="cb566-31"><a href="comparing-two-groups.html#cb566-31" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb566-32"><a href="comparing-two-groups.html#cb566-32" tabindex="-1"></a></span>
<span id="cb566-33"><a href="comparing-two-groups.html#cb566-33" tabindex="-1"></a><span class="co"># 4. Create one unique plot to annotate</span></span>
<span id="cb566-34"><a href="comparing-two-groups.html#cb566-34" tabindex="-1"></a>all_plots <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(female_t1_weight_boxplot, t1_3_weight_boxplot, male_3_task3_boxplot, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb566-35"><a href="comparing-two-groups.html#cb566-35" tabindex="-1"></a></span>
<span id="cb566-36"><a href="comparing-two-groups.html#cb566-36" tabindex="-1"></a><span class="co"># 5. Create the plot description</span></span>
<span id="cb566-37"><a href="comparing-two-groups.html#cb566-37" tabindex="-1"></a>description <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">&quot;A. Weight difference between T1-treated females at P15 vs. P30 (n = {sum(female_t1_weight_df$age == 15)} and {sum(female_t1_weight_df$age == 30)} respectively, Shapiro-Wilk p-value = {round(female_t1_weight_shapiro$shap[female_t1_weight_shapiro$age == 15], 3)} and {round(female_t1_weight_shapiro$shap[female_t1_weight_shapiro$age == 30], 3)} respectively, Bartlett&#39;s test p-value = {round(female_t1_weight_bartlett, 3)}, t-test p-value = {t_test_res$p.value}). B. Weight difference between T1-treated males and females at P3 (n = {sum(t1_3_weight_df$sex == &#39;Male&#39;)} and {sum(t1_3_weight_df$sex == &#39;Female&#39;)} respectively, Shapiro-Wilk p-value = {round(t1_3_weight_shapiro$shap[t1_3_weight_shapiro$sex == &#39;Male&#39;], 3)} and {round(t1_3_weight_shapiro$shap[t1_3_weight_shapiro$sex == &#39;Male&#39;], 3)} respectively, Bartlett&#39;s test p-value = {round(t1_3_weight_bartlett, 3)}, Welch&#39;s t-test p-value = {welch_res$p.value}). C. Task3 time difference between T1-treated and untreated males at P3 (n = {sum(male_3_task3_df$treatment == &#39;T1&#39;)} and {sum(male_3_task3_df$treatment == &#39;Untreated&#39;)} respectively, Shapiro-Wilk p-value = {round(male_3_task3_shapiro$shap[male_3_task3_shapiro$treatment == &#39;T1&#39;], 3)} and {round(male_3_task3_shapiro$shap[male_3_task3_shapiro$treatment == &#39;Untreated&#39;], 3)} respectively, MAnn-Whitney p-value = {mann_res$p.value}).&quot;</span>)</span>
<span id="cb566-38"><a href="comparing-two-groups.html#cb566-38" tabindex="-1"></a></span>
<span id="cb566-39"><a href="comparing-two-groups.html#cb566-39" tabindex="-1"></a><span class="co"># 6. Annotate plots</span></span>
<span id="cb566-40"><a href="comparing-two-groups.html#cb566-40" tabindex="-1"></a>all_plots <span class="ot">&lt;-</span> <span class="fu">annotate_figure</span>(all_plots, <span class="at">bottom =</span> <span class="fu">str_wrap</span>(description, <span class="dv">135</span>))</span></code></pre></div>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="comparing-two-groups.html#cb567-1" tabindex="-1"></a>all_plots</span></code></pre></div>
<p><img src="_main_files/figure-html/two_groups_boxplot3-1.svg" width="85%" style="display: block; margin: auto;" /></p>
<p>We can still improve our figure, but I think it sends a clear message.
I think that this is all you need to know to start your analysis when you have two groups.<br> In the next chapter, we will see how to deal with more than 2 groups.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="association-between-categorical-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparing-more-groups.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
